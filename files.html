<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 External files and literate programming | The targets R Package User Manual</title>
  <meta name="description" content="In-depth discussion of the major functionality of targets." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 External files and literate programming | The targets R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://wlandau.github.io/targets-manual" />
  <meta property="og:image" content="https://wlandau.github.io/targets-manual/man/figures/logo.png" />
  <meta property="og:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="github-repo" content="wlandau/targets-manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 External files and literate programming | The targets R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="twitter:image" content="https://wlandau.github.io/targets-manual/man/figures/logo.png" />

<meta name="author" content="Will Landau" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="man/figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="man/figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="practice.html"/>
<link rel="next" href="dynamic.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The targets R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pipeline-toolkits"><i class="fa fa-check"></i><b>1.2</b> Pipeline toolkits</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-targets-package"><i class="fa fa-check"></i><b>1.3</b> The <code>targets</code> package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-this-manual"><i class="fa fa-check"></i><b>1.4</b> About this manual</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-about-drake"><i class="fa fa-check"></i><b>1.5</b> What about <code>drake</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>2</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="2.1" data-path="walkthrough.html"><a href="walkthrough.html#about-the-example"><i class="fa fa-check"></i><b>2.1</b> About the example</a></li>
<li class="chapter" data-level="2.2" data-path="walkthrough.html"><a href="walkthrough.html#file-structure"><i class="fa fa-check"></i><b>2.2</b> File structure</a></li>
<li class="chapter" data-level="2.3" data-path="walkthrough.html"><a href="walkthrough.html#inspect-the-pipeline"><i class="fa fa-check"></i><b>2.3</b> Inspect the pipeline</a></li>
<li class="chapter" data-level="2.4" data-path="walkthrough.html"><a href="walkthrough.html#run-the-pipeline"><i class="fa fa-check"></i><b>2.4</b> Run the pipeline</a></li>
<li class="chapter" data-level="2.5" data-path="walkthrough.html"><a href="walkthrough.html#changes"><i class="fa fa-check"></i><b>2.5</b> Changes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="walkthrough.html"><a href="walkthrough.html#change-code"><i class="fa fa-check"></i><b>2.5.1</b> Change code</a></li>
<li class="chapter" data-level="2.5.2" data-path="walkthrough.html"><a href="walkthrough.html#change-data"><i class="fa fa-check"></i><b>2.5.2</b> Change data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="walkthrough.html"><a href="walkthrough.html#read-your-data"><i class="fa fa-check"></i><b>2.6</b> Read your data</a></li>
<li class="chapter" data-level="2.7" data-path="walkthrough.html"><a href="walkthrough.html#read-metadata"><i class="fa fa-check"></i><b>2.7</b> Read metadata</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practice.html"><a href="practice.html"><i class="fa fa-check"></i><b>3</b> Best practices for <code>targets</code>-powered projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="practice.html"><a href="practice.html#a-move-away-from-imperative-scripts"><i class="fa fa-check"></i><b>3.1</b> A move away from imperative scripts</a></li>
<li class="chapter" data-level="3.2" data-path="practice.html"><a href="practice.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="practice.html"><a href="practice.html#packages"><i class="fa fa-check"></i><b>3.3</b> Packages</a></li>
<li class="chapter" data-level="3.4" data-path="practice.html"><a href="practice.html#targets"><i class="fa fa-check"></i><b>3.4</b> Targets</a></li>
<li class="chapter" data-level="3.5" data-path="practice.html"><a href="practice.html#dependencies"><i class="fa fa-check"></i><b>3.5</b> Dependencies</a></li>
<li class="chapter" data-level="3.6" data-path="practice.html"><a href="practice.html#monitoring"><i class="fa fa-check"></i><b>3.6</b> Monitoring</a></li>
<li class="chapter" data-level="3.7" data-path="practice.html"><a href="practice.html#debugging"><i class="fa fa-check"></i><b>3.7</b> Debugging</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="practice.html"><a href="practice.html#workspaces"><i class="fa fa-check"></i><b>3.7.1</b> Workspaces</a></li>
<li class="chapter" data-level="3.7.2" data-path="practice.html"><a href="practice.html#interactive-debugging"><i class="fa fa-check"></i><b>3.7.2</b> Interactive debugging</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="practice.html"><a href="practice.html#performance"><i class="fa fa-check"></i><b>3.8</b> Performance</a></li>
<li class="chapter" data-level="3.9" data-path="practice.html"><a href="practice.html#cleaning-up"><i class="fa fa-check"></i><b>3.9</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>4</b> External files and literate programming</a>
<ul>
<li class="chapter" data-level="4.1" data-path="files.html"><a href="files.html#internal-files"><i class="fa fa-check"></i><b>4.1</b> Internal files</a></li>
<li class="chapter" data-level="4.2" data-path="files.html"><a href="files.html#external-input-files"><i class="fa fa-check"></i><b>4.2</b> External input files</a></li>
<li class="chapter" data-level="4.3" data-path="files.html"><a href="files.html#external-output-files"><i class="fa fa-check"></i><b>4.3</b> External output files</a></li>
<li class="chapter" data-level="4.4" data-path="files.html"><a href="files.html#literate-programming"><i class="fa fa-check"></i><b>4.4</b> Literate programming</a></li>
<li class="chapter" data-level="4.5" data-path="files.html"><a href="files.html#parameterized-r-markdown"><i class="fa fa-check"></i><b>4.5</b> Parameterized R Markdown</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="files.html"><a href="files.html#single-parameter-set"><i class="fa fa-check"></i><b>4.5.1</b> Single parameter set</a></li>
<li class="chapter" data-level="4.5.2" data-path="files.html"><a href="files.html#multiple-parameter-sets"><i class="fa fa-check"></i><b>4.5.2</b> Multiple parameter sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>5</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dynamic.html"><a href="dynamic.html#patterns"><i class="fa fa-check"></i><b>5.1</b> Patterns</a></li>
<li class="chapter" data-level="5.2" data-path="dynamic.html"><a href="dynamic.html#pattern-construction"><i class="fa fa-check"></i><b>5.2</b> Pattern construction</a></li>
<li class="chapter" data-level="5.3" data-path="dynamic.html"><a href="dynamic.html#branch-provenance"><i class="fa fa-check"></i><b>5.3</b> Branch provenance</a></li>
<li class="chapter" data-level="5.4" data-path="dynamic.html"><a href="dynamic.html#testing-patterns"><i class="fa fa-check"></i><b>5.4</b> Testing patterns</a></li>
<li class="chapter" data-level="5.5" data-path="dynamic.html"><a href="dynamic.html#dynamic-branching-over-files"><i class="fa fa-check"></i><b>5.5</b> Dynamic branching over files</a></li>
<li class="chapter" data-level="5.6" data-path="dynamic.html"><a href="dynamic.html#iteration"><i class="fa fa-check"></i><b>5.6</b> Iteration</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="dynamic.html"><a href="dynamic.html#vector-iteration"><i class="fa fa-check"></i><b>5.6.1</b> Vector iteration</a></li>
<li class="chapter" data-level="5.6.2" data-path="dynamic.html"><a href="dynamic.html#list-iteration"><i class="fa fa-check"></i><b>5.6.2</b> List iteration</a></li>
<li class="chapter" data-level="5.6.3" data-path="dynamic.html"><a href="dynamic.html#group-iteration"><i class="fa fa-check"></i><b>5.6.3</b> Group iteration</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="dynamic.html"><a href="dynamic.html#batching"><i class="fa fa-check"></i><b>5.7</b> Batching</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>6</b> Static branching</a>
<ul>
<li class="chapter" data-level="6.1" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>6.1</b> Map</a></li>
<li class="chapter" data-level="6.2" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>6.2</b> Combine</a></li>
<li class="chapter" data-level="6.3" data-path="static.html"><a href="static.html#metaprogramming"><i class="fa fa-check"></i><b>6.3</b> Metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>7</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hpc.html"><a href="hpc.html#clustermq"><i class="fa fa-check"></i><b>7.1</b> Clustermq</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="hpc.html"><a href="hpc.html#clustermq-installation"><i class="fa fa-check"></i><b>7.1.1</b> Clustermq installation</a></li>
<li class="chapter" data-level="7.1.2" data-path="hpc.html"><a href="hpc.html#clustermq-locally"><i class="fa fa-check"></i><b>7.1.2</b> Clustermq locally</a></li>
<li class="chapter" data-level="7.1.3" data-path="hpc.html"><a href="hpc.html#clustermq-remotely"><i class="fa fa-check"></i><b>7.1.3</b> Clustermq remotely</a></li>
<li class="chapter" data-level="7.1.4" data-path="hpc.html"><a href="hpc.html#clustermq-configuration"><i class="fa fa-check"></i><b>7.1.4</b> Clustermq configuration</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="hpc.html"><a href="hpc.html#future"><i class="fa fa-check"></i><b>7.2</b> Future</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="hpc.html"><a href="hpc.html#future-installation"><i class="fa fa-check"></i><b>7.2.1</b> Future installation</a></li>
<li class="chapter" data-level="7.2.2" data-path="hpc.html"><a href="hpc.html#future-locally"><i class="fa fa-check"></i><b>7.2.2</b> Future locally</a></li>
<li class="chapter" data-level="7.2.3" data-path="hpc.html"><a href="hpc.html#future-remotely"><i class="fa fa-check"></i><b>7.2.3</b> Future remotely</a></li>
<li class="chapter" data-level="7.2.4" data-path="hpc.html"><a href="hpc.html#future-configuration"><i class="fa fa-check"></i><b>7.2.4</b> Future configuration</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="hpc.html"><a href="hpc.html#advanced"><i class="fa fa-check"></i><b>7.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cloud.html"><a href="cloud.html"><i class="fa fa-check"></i><b>8</b> Cloud integration</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cloud.html"><a href="cloud.html#compute"><i class="fa fa-check"></i><b>8.1</b> Compute</a></li>
<li class="chapter" data-level="8.2" data-path="cloud.html"><a href="cloud.html#storage"><i class="fa fa-check"></i><b>8.2</b> Storage</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cloud.html"><a href="cloud.html#get-started-with-the-amazon-s3-web-console"><i class="fa fa-check"></i><b>8.2.1</b> Get started with the Amazon S3 web console</a></li>
<li class="chapter" data-level="8.2.2" data-path="cloud.html"><a href="cloud.html#configure-your-local-machine"><i class="fa fa-check"></i><b>8.2.2</b> Configure your local machine</a></li>
<li class="chapter" data-level="8.2.3" data-path="cloud.html"><a href="cloud.html#create-s3-buckets"><i class="fa fa-check"></i><b>8.2.3</b> Create S3 buckets</a></li>
<li class="chapter" data-level="8.2.4" data-path="cloud.html"><a href="cloud.html#configure-the-pipeline"><i class="fa fa-check"></i><b>8.2.4</b> Configure the pipeline</a></li>
<li class="chapter" data-level="8.2.5" data-path="cloud.html"><a href="cloud.html#run-the-pipeline-1"><i class="fa fa-check"></i><b>8.2.5</b> Run the pipeline</a></li>
<li class="chapter" data-level="8.2.6" data-path="cloud.html"><a href="cloud.html#manage-the-data"><i class="fa fa-check"></i><b>8.2.6</b> Manage the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="drake.html"><a href="drake.html"><i class="fa fa-check"></i><b>9</b> What about <code>drake</code>?</a>
<ul>
<li class="chapter" data-level="9.1" data-path="drake.html"><a href="drake.html#transitioning-to-targets"><i class="fa fa-check"></i><b>9.1</b> Transitioning to <code>targets</code></a></li>
<li class="chapter" data-level="9.2" data-path="drake.html"><a href="drake.html#advantages-of-targets-over-drake"><i class="fa fa-check"></i><b>9.2</b> Advantages of <code>targets</code> over <code>drake</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="drake.html"><a href="drake.html#better-guardrails-by-design"><i class="fa fa-check"></i><b>9.2.1</b> Better guardrails by design</a></li>
<li class="chapter" data-level="9.2.2" data-path="drake.html"><a href="drake.html#enhanced-debugging-support"><i class="fa fa-check"></i><b>9.2.2</b> Enhanced debugging support</a></li>
<li class="chapter" data-level="9.2.3" data-path="drake.html"><a href="drake.html#improved-tracking-of-package-functions"><i class="fa fa-check"></i><b>9.2.3</b> Improved tracking of package functions</a></li>
<li class="chapter" data-level="9.2.4" data-path="drake.html"><a href="drake.html#lighter-friendlier-data-management"><i class="fa fa-check"></i><b>9.2.4</b> Lighter, friendlier data management</a></li>
<li class="chapter" data-level="9.2.5" data-path="drake.html"><a href="drake.html#cloud-storage"><i class="fa fa-check"></i><b>9.2.5</b> Cloud storage</a></li>
<li class="chapter" data-level="9.2.6" data-path="drake.html"><a href="drake.html#show-status-of-functions-and-global-objects"><i class="fa fa-check"></i><b>9.2.6</b> Show status of functions and global objects</a></li>
<li class="chapter" data-level="9.2.7" data-path="drake.html"><a href="drake.html#dynamic-branching-with-dplyrgroup_by"><i class="fa fa-check"></i><b>9.2.7</b> Dynamic branching with <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="9.2.8" data-path="drake.html"><a href="drake.html#composable-dynamic-branching"><i class="fa fa-check"></i><b>9.2.8</b> Composable dynamic branching</a></li>
<li class="chapter" data-level="9.2.9" data-path="drake.html"><a href="drake.html#improved-parallel-efficiency"><i class="fa fa-check"></i><b>9.2.9</b> Improved parallel efficiency</a></li>
<li class="chapter" data-level="9.2.10" data-path="drake.html"><a href="drake.html#metaprogramming-1"><i class="fa fa-check"></i><b>9.2.10</b> Metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The targets R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="files" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> External files and literate programming</h1>
<p>The <code>targets</code> package automatically stores data and automatically responds to changed files to keep your targets up to date. The chapter below explains how to leverage this reproducibility for external datasets, external output files, and literate programming artifacts such as R Markdown reports. Real-world applications of these techniques are <a href="https://wlandau.github.io/targets/index.html#examples">linked from here</a>.</p>
<div id="internal-files" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Internal files</h2>
<p>Each project’s data lives in the <code>_targets/</code> folder in the root directory (where you call <code>tar_make()</code>). The files in the <code>_targets/</code> look like this:</p>
<pre><code>_targets/
├── meta/
├────── progress
├────── meta
├── objects/
├────── target1 
├────── target2
├────── branching_target_c7bcb4bd
├────── branching_target_285fb6a9
├────── branching_target_874ca381
└── scratch/ # tar_make() deletes this folder after it finishes.</code></pre>
<p>Spreadsheets <code>_targets/meta/meta</code> and <code>_targets/meta/progress</code> keep track of target metadata, and the <code>scratch/</code> directory contains temporary files which can be safely deleted after <code>tar_make()</code> finishes. The <code>_targets/objects/</code> folder contains the return values of the targets themselves.</p>
<p>A typical target returns an R object: for example, a dataset with <code>tar_target(dataset, data.frame(x = rnorm(1000)), format = "fst")</code> or a fitted model <code>tar_target(model, biglm(ozone ~ temp + wind), format = "qs")</code>. When you run the pipeline, <code>targets</code> computes this object and saves it as a file in <code>_targets/objects/</code>. The file name in <code>_targets/objects/</code> is always the target name, and type of the file is determined by the <code>format</code> argument of <code>tar_target()</code>, and formats <code>"fst"</code> and <code>"qs"</code> are two of many choices explained in the help file of <code>tar_target()</code>. No matter what format you pick, <code>targets</code> watches the file for changes and recomputes the target in <code>tar_make()</code> if the the file gets corrupted (unless you suppress the file cue with <code>tar_target(cue = tar_cue(file = FALSE))</code>).</p>
</div>
<div id="external-input-files" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> External input files</h2>
<p>To reproducibly track an external input file, you need to define a new target and choose <code>format = "file"</code> in <code>tar_target()</code>. Targets with the <code>"file"</code> format are called dynamic files, and these targets are unusual because their return values do not get saved in the <code>_targets/objects/</code> folder. Rather, they expect you to return a character vector files and directories, which gets stored in the <code>_targets/meta</code> spreadsheet, and then <code>targets</code> watches the data at those paths for changes. The first two targets of the <a href="https://github.com/wlandau/targets-minimal">minimal example</a> demonstrate this technique.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="files.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_script</span>({</span>
<span id="cb39-2"><a href="files.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  path_to_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb39-3"><a href="files.html#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data/raw_data.csv&quot;</span></span>
<span id="cb39-4"><a href="files.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-5"><a href="files.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb39-6"><a href="files.html#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tar_target</span>(</span>
<span id="cb39-7"><a href="files.html#cb39-7" aria-hidden="true" tabindex="-1"></a>      raw_data_file,</span>
<span id="cb39-8"><a href="files.html#cb39-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">path_to_data</span>(),</span>
<span id="cb39-9"><a href="files.html#cb39-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">&quot;file&quot;</span></span>
<span id="cb39-10"><a href="files.html#cb39-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-11"><a href="files.html#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tar_target</span>(</span>
<span id="cb39-12"><a href="files.html#cb39-12" aria-hidden="true" tabindex="-1"></a>      raw_data,</span>
<span id="cb39-13"><a href="files.html#cb39-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">read_csv</span>(raw_data_file, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb39-14"><a href="files.html#cb39-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-15"><a href="files.html#cb39-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-16"><a href="files.html#cb39-16" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Above, <code>raw_data_file</code> is the dynamic file target. The file <code>data/raw_data.csv</code> exists before we ever run the pipeline, and the R expresion for the target returns the character vector <code>"data/raw_data.csv"</code>. (We use the <code>path_to_data()</code> function to demonstrate that you need not literally write <code>"data/raw_data.csv"</code> as long as the path is returned somehow.)</p>
<p>All subsequent targets that depend on the file must reference the file using the symbol <code>raw_data_file</code>. This allows <code>targets</code>’ automatic static code analysis routines to detect which targets depend on the file. Because the <code>raw_data</code> target literally mentions the symbol <code>raw_data_file</code>, <code>targets</code> knows <code>raw_data</code> depends on <code>raw_data_file</code>. This ensures that</p>
<ol style="list-style-type: decimal">
<li><code>raw_data_file</code> gets processed before <code>raw_data</code>, and</li>
<li><code>tar_make()</code> automatically reruns <code>raw_data</code> if <code>raw_data_file</code> or <code>"data/raw_data.csv"</code> change.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="files.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_visnetwork</span>()</span></code></pre></div>
<div id="htmlwidget-b1a918aa50b39434ff22" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-b1a918aa50b39434ff22">{"x":{"nodes":{"name":["raw_data","raw_data_file","path_to_data"],"type":["stem","stem","function"],"status":["outdated","outdated","outdated"],"seconds":[null,null,null],"bytes":[null,null,null],"branches":[null,null,null],"id":["raw_data","raw_data_file","path_to_data"],"label":["raw_data","raw_data_file","path_to_data"],"font.size":[20,20,20],"level":[3,2,1],"color":["#78B7C5","#78B7C5","#78B7C5"],"shape":["dot","dot","triangle"]},"edges":{"from":["raw_data_file","path_to_data"],"to":["raw_data","raw_data_file"],"arrows":["to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Stem","Function"],"color":["#78B7C5","#899DA4","#899DA4"],"shape":["dot","dot","triangle"],"font.size":[20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
<p>If we were to omit the symbol <code>raw_data_file</code> from the R expression of <code>raw_data</code>, those targets would be disconnected in the graph and <code>tar_make()</code> would make incorrect decisions.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="files.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_script</span>({</span>
<span id="cb41-2"><a href="files.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  path_to_data <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb41-3"><a href="files.html#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data/raw_data.csv&quot;</span></span>
<span id="cb41-4"><a href="files.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-5"><a href="files.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb41-6"><a href="files.html#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tar_target</span>(</span>
<span id="cb41-7"><a href="files.html#cb41-7" aria-hidden="true" tabindex="-1"></a>      raw_data_file,</span>
<span id="cb41-8"><a href="files.html#cb41-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">path_to_data</span>(),</span>
<span id="cb41-9"><a href="files.html#cb41-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="st">&quot;file&quot;</span></span>
<span id="cb41-10"><a href="files.html#cb41-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-11"><a href="files.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tar_target</span>(</span>
<span id="cb41-12"><a href="files.html#cb41-12" aria-hidden="true" tabindex="-1"></a>      raw_data,</span>
<span id="cb41-13"><a href="files.html#cb41-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">read_csv</span>(<span class="st">&quot;data/raw_data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>()) <span class="co"># incorrect</span></span>
<span id="cb41-14"><a href="files.html#cb41-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-15"><a href="files.html#cb41-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-16"><a href="files.html#cb41-16" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="files.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_visnetwork</span>()</span></code></pre></div>
<div id="htmlwidget-457ff21c7a89464425c6" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-457ff21c7a89464425c6">{"x":{"nodes":{"name":["raw_data","raw_data_file","path_to_data"],"type":["stem","stem","function"],"status":["outdated","outdated","outdated"],"seconds":[null,null,null],"bytes":[null,null,null],"branches":[null,null,null],"id":["raw_data","raw_data_file","path_to_data"],"label":["raw_data","raw_data_file","path_to_data"],"font.size":[20,20,20],"level":[0,2,1],"color":["#78B7C5","#78B7C5","#78B7C5"],"shape":["dot","dot","triangle"]},"edges":{"from":["path_to_data"],"to":["raw_data_file"],"arrows":["to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Outdated","Stem","Function"],"color":["#78B7C5","#899DA4","#899DA4"],"shape":["dot","dot","triangle"],"font.size":[20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="external-output-files" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> External output files</h2>
<p>We can generate and track custom external files too, and the mechanics are similar. We still return a file path and use <code>format = "file"</code>, but this time, our R command writes a file before it returns a path. For an external plot file, our target might look like this.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="files.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_target</span>(</span>
<span id="cb43-2"><a href="files.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  plot_file,</span>
<span id="cb43-3"><a href="files.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save_plot_and_return_path</span>(),</span>
<span id="cb43-4"><a href="files.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;file&quot;</span></span>
<span id="cb43-5"><a href="files.html#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>where our custom <code>save_plot_and_return_path()</code> function does exactly what the name describes.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="files.html#cb44-1" aria-hidden="true" tabindex="-1"></a>save_plot_and_return_path <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb44-2"><a href="files.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars) <span class="sc">+</span></span>
<span id="cb44-3"><a href="files.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg))</span>
<span id="cb44-4"><a href="files.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">&quot;plot_file.png&quot;</span>, plot, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb44-5"><a href="files.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">&quot;plot_file.png&quot;</span>)</span>
<span id="cb44-6"><a href="files.html#cb44-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="literate-programming" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Literate programming</h2>
<p>R Markdown reports are a little more challenging because they often depend on upstream targets. To integrate an R Markdown report with a <code>targets</code> pipeline, you must use <code>tar_read()</code> and <code>tar_load()</code> in active code chunks to explicitly name the targets that the report depends on. (Do not use <code>tar_read_raw()</code> or <code>tar_load_raw()</code> for this.) The report from the <a href="https://github.com/wlandau/targets-minimal">minimal example</a> looks like this.</p>
<p><img src="man/figures/knitr-source.png" /></p>
<p>Above, the report depends on targets <code>fit</code> and <code>hist</code>. The use of <code>tar_read()</code> and <code>tar_load()</code> allows us to run the report outside the pipeline. (Again, do not use <code>tar_read_raw()</code> or <code>tar_load_raw()</code> for this.) As long as <code>_targets/</code> folder has data on the required targets from a previous <code>tar_make()</code>, you can open the RStudio IDE, edit the report, and click the Knit button like you would for any other R Markdown report.</p>
<p><img src="man/figures/knitr-ide.png" /></p>
<p>To connect the target with the pipeline, we define a special kind of target using <code>tar_render()</code> from the <a href="https://github.com/wlandau/tarchetypes"><code>tarchetypes</code></a> package instead of the usual <code>tar_target()</code>, which</p>
<ol style="list-style-type: decimal">
<li>Finds all the <code>tar_load()</code>/<code>tar_read()</code> dependencies in the report and inserts them into the target’s command. This enforces the proper dependency relationships. (<code>tar_load_raw()</code> and <code>tar_read_raw()</code> are ignored because those dependencies cannot be resolved with static code analysis.)</li>
<li>Sets <code>format = "file"</code> (see <code>tar_target()</code>) so <code>targets</code> watches the files at the returned paths.</li>
<li>Configures the target’s command to return both the output report files and the input source file. All these file paths are relative paths so the project stays portable.</li>
<li>Forces the report to run in the user’s current working directory instead of the working directory of the report.</li>
<li>Sets convenient default options such as <code>deployment = "main"</code> in <code>tar_target()</code> and <code>quiet = TRUE</code> in <code>rmarkdown::render()</code>.</li>
</ol>
<p>The target definition looks like this.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="files.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb45-2"><a href="files.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>)</span>
<span id="cb45-3"><a href="files.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &lt;stem target&gt; </span></span>
<span id="cb45-4"><a href="files.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   name: report </span></span>
<span id="cb45-5"><a href="files.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   command:</span></span>
<span id="cb45-6"><a href="files.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tarchetypes::tar_render_run(path = &quot;report.Rmd&quot;, args = list(input = &quot;report.Rmd&quot;, </span></span>
<span id="cb45-7"><a href="files.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         knit_root_dir = getwd(), quiet = TRUE), deps = list(fit, </span></span>
<span id="cb45-8"><a href="files.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         hist)) </span></span>
<span id="cb45-9"><a href="files.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   format: file </span></span>
<span id="cb45-10"><a href="files.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   iteration method: vector </span></span>
<span id="cb45-11"><a href="files.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   error mode: stop </span></span>
<span id="cb45-12"><a href="files.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   memory mode: persistent </span></span>
<span id="cb45-13"><a href="files.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   storage mode: main </span></span>
<span id="cb45-14"><a href="files.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   retrieval mode: main </span></span>
<span id="cb45-15"><a href="files.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   deploy to: main </span></span>
<span id="cb45-16"><a href="files.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   resources:</span></span>
<span id="cb45-17"><a href="files.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     list() </span></span>
<span id="cb45-18"><a href="files.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   cue:</span></span>
<span id="cb45-19"><a href="files.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     mode: thorough</span></span>
<span id="cb45-20"><a href="files.html#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     command: TRUE</span></span>
<span id="cb45-21"><a href="files.html#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     depend: TRUE</span></span>
<span id="cb45-22"><a href="files.html#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     format: TRUE</span></span>
<span id="cb45-23"><a href="files.html#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     iteration: TRUE</span></span>
<span id="cb45-24"><a href="files.html#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     file: TRUE </span></span>
<span id="cb45-25"><a href="files.html#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   packages:</span></span>
<span id="cb45-26"><a href="files.html#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tarchetypes</span></span>
<span id="cb45-27"><a href="files.html#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     biglm</span></span>
<span id="cb45-28"><a href="files.html#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     DBI</span></span>
<span id="cb45-29"><a href="files.html#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     withr</span></span>
<span id="cb45-30"><a href="files.html#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     forcats</span></span>
<span id="cb45-31"><a href="files.html#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     stringr</span></span>
<span id="cb45-32"><a href="files.html#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     dplyr</span></span>
<span id="cb45-33"><a href="files.html#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     purrr</span></span>
<span id="cb45-34"><a href="files.html#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     readr</span></span>
<span id="cb45-35"><a href="files.html#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tidyr</span></span>
<span id="cb45-36"><a href="files.html#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tibble</span></span>
<span id="cb45-37"><a href="files.html#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ggplot2</span></span>
<span id="cb45-38"><a href="files.html#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tidyverse</span></span>
<span id="cb45-39"><a href="files.html#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     targets</span></span>
<span id="cb45-40"><a href="files.html#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     fs</span></span>
<span id="cb45-41"><a href="files.html#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     stats</span></span>
<span id="cb45-42"><a href="files.html#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     graphics</span></span>
<span id="cb45-43"><a href="files.html#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     grDevices</span></span>
<span id="cb45-44"><a href="files.html#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     utils</span></span>
<span id="cb45-45"><a href="files.html#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     datasets</span></span>
<span id="cb45-46"><a href="files.html#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     methods</span></span>
<span id="cb45-47"><a href="files.html#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     base </span></span>
<span id="cb45-48"><a href="files.html#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   library:</span></span>
<span id="cb45-49"><a href="files.html#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     NULL</span></span></code></pre></div>
<p>Because symbols <code>fit</code> and <code>hist</code> appear in the command, <code>targets</code> knows that <code>report</code> depends on <code>fit</code> and <code>hist</code>. When we put the <code>report</code> target in the pipeline, these dependency relationships show up in the graph.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="files.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb46-2"><a href="files.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb46-3"><a href="files.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb46-4"><a href="files.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span>
<span id="cb46-5"><a href="files.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb46-6"><a href="files.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb46-7"><a href="files.html#cb46-7" aria-hidden="true" tabindex="-1"></a>    raw_data_file,</span>
<span id="cb46-8"><a href="files.html#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data/raw_data.csv&quot;</span>,</span>
<span id="cb46-9"><a href="files.html#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">&quot;file&quot;</span></span>
<span id="cb46-10"><a href="files.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-11"><a href="files.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb46-12"><a href="files.html#cb46-12" aria-hidden="true" tabindex="-1"></a>    raw_data,</span>
<span id="cb46-13"><a href="files.html#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(raw_data_file, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb46-14"><a href="files.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-15"><a href="files.html#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb46-16"><a href="files.html#cb46-16" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb46-17"><a href="files.html#cb46-17" aria-hidden="true" tabindex="-1"></a>    raw_data <span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="files.html#cb46-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb46-19"><a href="files.html#cb46-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-20"><a href="files.html#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(hist, <span class="fu">create_plot</span>(data)),</span>
<span id="cb46-21"><a href="files.html#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(fit, <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)),</span>
<span id="cb46-22"><a href="files.html#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>) <span class="co"># Here is our call to tar_render().</span></span>
<span id="cb46-23"><a href="files.html#cb46-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="files.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_visnetwork</span>()</span></code></pre></div>
<p><img src="man/figures/knitr-graph.png" /></p>
</div>
<div id="parameterized-r-markdown" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Parameterized R Markdown</h2>
<p>Functions in <a href="https://wlandau.github.io/tarchetypes"><code>tarchetypes</code></a> make it straightforward to use <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">parameterized R Markdown</a> in a <code>targets</code> pipeline. The next two subsections walk through the major use cases.</p>
<div id="single-parameter-set" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Single parameter set</h3>
<p>In this scenario, the pipeline renders your <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">parameterized R Markdown</a> report one time using a single set of parameters. These parameters can be upstream targets, global objects, or fixed values. Simply pass a <code>params</code> argument to <a href="https://wlandau.github.io/tarchetypes/reference/tar_render.html"><code>tarchetypes::tar_render()</code></a>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="files.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb48-2"><a href="files.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb48-3"><a href="files.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb48-4"><a href="files.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb48-5"><a href="files.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(data, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq_len</span>(<span class="dv">26</span>), <span class="at">y =</span> letters))</span>
<span id="cb48-6"><a href="files.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">your_param =</span> data))</span>
<span id="cb48-7"><a href="files.html#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>the <code>report</code> target will run:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="files.html#cb49-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="st">&quot;report.Rmd&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">your_param =</span> your_target))</span></code></pre></div>
<p>where <code>report.Rmd</code> has the following YAML front matter:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb50-1"><a href="files.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb50-2"><a href="files.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> report</span></span>
<span id="cb50-3"><a href="files.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output_format</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb50-4"><a href="files.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb50-5"><a href="files.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">your_param</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;default value&quot;</span></span>
<span id="cb50-6"><a href="files.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>and the following code chunk:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="files.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(params<span class="sc">$</span>your_param)</span></code></pre></div>
<p>See <a href="https://wlandau.github.io/tarchetypes/reference/tar_render.html#examples">these examples</a> for a demonstration.</p>
</div>
<div id="multiple-parameter-sets" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Multiple parameter sets</h3>
<p>In this scenario, you still have a single report, but you render it multiple times over multiple sets of <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">R Markdown parameters</a>. This time, use <a href="https://wlandau.github.io/tarchetypes/reference/tar_render_rep.html"><code>tarchetypes::tar_render_rep()</code></a> and write code to reference or generate a grid of parameters with one row per rendered report and one column per parameter. Optionally, you can also include an <code>output_file</code> column to control the file paths of the generated reports, and you can set the number of batches to reduce the overhead that would otherwise ensue from creating a large number of targets.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="files.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb52-2"><a href="files.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb52-3"><a href="files.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb52-4"><a href="files.html#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb52-5"><a href="files.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb52-6"><a href="files.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(x, <span class="st">&quot;value_of_x&quot;</span>),</span>
<span id="cb52-7"><a href="files.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render_rep</span>(</span>
<span id="cb52-8"><a href="files.html#cb52-8" aria-hidden="true" tabindex="-1"></a>    report,</span>
<span id="cb52-9"><a href="files.html#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;report.Rmd&quot;</span>,</span>
<span id="cb52-10"><a href="files.html#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">tibble</span>(</span>
<span id="cb52-11"><a href="files.html#cb52-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&quot;par_val_1&quot;</span>, <span class="st">&quot;par_val_2&quot;</span>, <span class="st">&quot;par_val_3&quot;</span>, <span class="st">&quot;par_val_4&quot;</span>),</span>
<span id="cb52-12"><a href="files.html#cb52-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">output_file =</span> <span class="fu">c</span>(<span class="st">&quot;f1.html&quot;</span>, <span class="st">&quot;f2.html&quot;</span>, <span class="st">&quot;f3.html&quot;</span>, <span class="st">&quot;f4.html&quot;</span>)</span>
<span id="cb52-13"><a href="files.html#cb52-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb52-14"><a href="files.html#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">batches =</span> <span class="dv">2</span></span>
<span id="cb52-15"><a href="files.html#cb52-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-16"><a href="files.html#cb52-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>where <code>report.Rmd</code> has the following YAML front matter:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb53-1"><a href="files.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> report</span></span>
<span id="cb53-2"><a href="files.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">output_format</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb53-3"><a href="files.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb53-4"><a href="files.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">par</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;default value&quot;</span></span></code></pre></div>
<p>and the following R code chunk:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="files.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(params<span class="sc">$</span>par)</span>
<span id="cb54-2"><a href="files.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tar_read</span>(x))</span></code></pre></div>
<p><code>tar_render_rep()</code> creates multiple targets to set up the R Markdown part of the workflow, including a target for the grid of parameters and a <a href="dynamic.html#dynamic">dynamic branching</a> target to iterate over the parameters in batches. In this case, we have two batches (dynamic branches) and each one renders the report twice.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="files.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb55-2"><a href="files.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target x</span></span>
<span id="cb55-3"><a href="files.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target report_params</span></span>
<span id="cb55-4"><a href="files.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run branch report_9e7470a1</span></span>
<span id="cb55-5"><a href="files.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run branch report_457829de</span></span></code></pre></div>
<p>The third output file <code>f3.html</code> is below, and the rest look similar.</p>
<p><img src="man/figures/dynamic-rmarkdown-params.png" /></p>
<p>For more information, see <a href="https://wlandau.github.io/tarchetypes/reference/tar_render_rep.html#examples">these examples</a>.</p>

</div>
</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="practice.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/wlandau/targets-manual/edit/main/files.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/wlandau/targets-manual/commits/main/files.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
