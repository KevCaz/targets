<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Literate programming | The targets R Package User Manual</title>
  <meta name="description" content="In-depth discussion of the major functionality of targets." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Literate programming | The targets R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />
  <meta property="og:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="github-repo" content="ropensci-books/targets" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Literate programming | The targets R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="twitter:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />

<meta name="author" content="Will Landau" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="man/figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="man/figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="data.html"/>
<link rel="next" href="dynamic.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The targets R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pipeline-tools"><i class="fa fa-check"></i><b>1.2</b> Pipeline tools</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-targets-package"><i class="fa fa-check"></i><b>1.3</b> The <code>targets</code> package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-this-manual"><i class="fa fa-check"></i><b>1.4</b> About this manual</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-about-drake"><i class="fa fa-check"></i><b>1.5</b> What about <code>drake</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>2</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="2.1" data-path="walkthrough.html"><a href="walkthrough.html#about-this-example"><i class="fa fa-check"></i><b>2.1</b> About this example</a></li>
<li class="chapter" data-level="2.2" data-path="walkthrough.html"><a href="walkthrough.html#file-structure"><i class="fa fa-check"></i><b>2.2</b> File structure</a></li>
<li class="chapter" data-level="2.3" data-path="walkthrough.html"><a href="walkthrough.html#target-script-file"><i class="fa fa-check"></i><b>2.3</b> Target script file</a></li>
<li class="chapter" data-level="2.4" data-path="walkthrough.html"><a href="walkthrough.html#inspect-the-pipeline"><i class="fa fa-check"></i><b>2.4</b> Inspect the pipeline</a></li>
<li class="chapter" data-level="2.5" data-path="walkthrough.html"><a href="walkthrough.html#run-the-pipeline"><i class="fa fa-check"></i><b>2.5</b> Run the pipeline</a></li>
<li class="chapter" data-level="2.6" data-path="walkthrough.html"><a href="walkthrough.html#changes"><i class="fa fa-check"></i><b>2.6</b> Changes</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="walkthrough.html"><a href="walkthrough.html#change-code"><i class="fa fa-check"></i><b>2.6.1</b> Change code</a></li>
<li class="chapter" data-level="2.6.2" data-path="walkthrough.html"><a href="walkthrough.html#change-data"><i class="fa fa-check"></i><b>2.6.2</b> Change data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="walkthrough.html"><a href="walkthrough.html#read-metadata"><i class="fa fa-check"></i><b>2.7</b> Read metadata</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>3</b> Debugging</a>
<ul>
<li class="chapter" data-level="3.1" data-path="debugging.html"><a href="debugging.html#error-messages"><i class="fa fa-check"></i><b>3.1</b> Error messages</a></li>
<li class="chapter" data-level="3.2" data-path="debugging.html"><a href="debugging.html#environment-browser"><i class="fa fa-check"></i><b>3.2</b> Environment browser</a></li>
<li class="chapter" data-level="3.3" data-path="debugging.html"><a href="debugging.html#the-debug-option"><i class="fa fa-check"></i><b>3.3</b> The debug option</a></li>
<li class="chapter" data-level="3.4" data-path="debugging.html"><a href="debugging.html#workspaces"><i class="fa fa-check"></i><b>3.4</b> Workspaces</a></li>
<li class="chapter" data-level="3.5" data-path="debugging.html"><a href="debugging.html#tradeoffs"><i class="fa fa-check"></i><b>3.5</b> Tradeoffs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>4</b> Performance</a>
<ul>
<li class="chapter" data-level="4.1" data-path="performance.html"><a href="performance.html#monitoring-the-pipeline"><i class="fa fa-check"></i><b>4.1</b> Monitoring the pipeline</a></li>
<li class="chapter" data-level="4.2" data-path="performance.html"><a href="performance.html#performance-1"><i class="fa fa-check"></i><b>4.2</b> Performance</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#problems-with-script-based-workflows"><i class="fa fa-check"></i><b>5.1</b> Problems with script-based workflows</a></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>5.2</b> Functions</a></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>5.3</b> Writing functions</a></li>
<li class="chapter" data-level="5.4" data-path="functions.html"><a href="functions.html#functions-in-pipelines"><i class="fa fa-check"></i><b>5.4</b> Functions in pipelines</a></li>
<li class="chapter" data-level="5.5" data-path="functions.html"><a href="functions.html#tracking-changes"><i class="fa fa-check"></i><b>5.5</b> Tracking changes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="targets.html"><a href="targets.html"><i class="fa fa-check"></i><b>6</b> Target construction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="targets.html"><a href="targets.html#target-names"><i class="fa fa-check"></i><b>6.1</b> Target names</a></li>
<li class="chapter" data-level="6.2" data-path="targets.html"><a href="targets.html#what-a-target-should-do"><i class="fa fa-check"></i><b>6.2</b> What a target should do</a></li>
<li class="chapter" data-level="6.3" data-path="targets.html"><a href="targets.html#how-much-a-target-should-do"><i class="fa fa-check"></i><b>6.3</b> How much a target should do</a></li>
<li class="chapter" data-level="6.4" data-path="targets.html"><a href="targets.html#working-with-tools-outside-r"><i class="fa fa-check"></i><b>6.4</b> Working with tools outside R</a></li>
<li class="chapter" data-level="6.5" data-path="targets.html"><a href="targets.html#side-effects"><i class="fa fa-check"></i><b>6.5</b> Side effects</a></li>
<li class="chapter" data-level="6.6" data-path="targets.html"><a href="targets.html#dependencies"><i class="fa fa-check"></i><b>6.6</b> Dependencies</a></li>
<li class="chapter" data-level="6.7" data-path="targets.html"><a href="targets.html#return-value"><i class="fa fa-check"></i><b>6.7</b> Return value</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="targets.html"><a href="targets.html#saving"><i class="fa fa-check"></i><b>6.7.1</b> Saving</a></li>
<li class="chapter" data-level="6.7.2" data-path="targets.html"><a href="targets.html#hashing"><i class="fa fa-check"></i><b>6.7.2</b> Hashing</a></li>
<li class="chapter" data-level="6.7.3" data-path="targets.html"><a href="targets.html#workaround"><i class="fa fa-check"></i><b>6.7.3</b> Workaround</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>7</b> Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="packages.html"><a href="packages.html#loading-and-configuring-r-packages"><i class="fa fa-check"></i><b>7.1</b> Loading and configuring R packages</a></li>
<li class="chapter" data-level="7.2" data-path="packages.html"><a href="packages.html#r-packages-as-projects"><i class="fa fa-check"></i><b>7.2</b> R packages as projects</a></li>
<li class="chapter" data-level="7.3" data-path="packages.html"><a href="packages.html#target-factories"><i class="fa fa-check"></i><b>7.3</b> Target Factories</a></li>
<li class="chapter" data-level="7.4" data-path="packages.html"><a href="packages.html#package-based-invalidation"><i class="fa fa-check"></i><b>7.4</b> Package-based invalidation</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>8</b> Projects</a>
<ul>
<li class="chapter" data-level="8.1" data-path="projects.html"><a href="projects.html#extra-reproducibility"><i class="fa fa-check"></i><b>8.1</b> Extra reproducibility</a></li>
<li class="chapter" data-level="8.2" data-path="projects.html"><a href="projects.html#project-files"><i class="fa fa-check"></i><b>8.2</b> Project files</a></li>
<li class="chapter" data-level="8.3" data-path="projects.html"><a href="projects.html#multiple-projects"><i class="fa fa-check"></i><b>8.3</b> Multiple projects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="projects.html"><a href="projects.html#create-each-project."><i class="fa fa-check"></i><b>8.3.1</b> Create each project.</a></li>
<li class="chapter" data-level="8.3.2" data-path="projects.html"><a href="projects.html#configure-each-project."><i class="fa fa-check"></i><b>8.3.2</b> Configure each project.</a></li>
<li class="chapter" data-level="8.3.3" data-path="projects.html"><a href="projects.html#run-each-project"><i class="fa fa-check"></i><b>8.3.3</b> Run each project</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="projects.html"><a href="projects.html#interdependent-projects"><i class="fa fa-check"></i><b>8.4</b> Interdependent projects</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="projects.html"><a href="projects.html#config-inheritance"><i class="fa fa-check"></i><b>8.4.1</b> Config inheritance</a></li>
<li class="chapter" data-level="8.4.2" data-path="projects.html"><a href="projects.html#sharing-targets"><i class="fa fa-check"></i><b>8.4.2</b> Sharing targets</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="projects.html"><a href="projects.html#the-config-package"><i class="fa fa-check"></i><b>8.5</b> The config package</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>9</b> Data: storage and memory</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data.html"><a href="data.html#local-data-store"><i class="fa fa-check"></i><b>9.1</b> Local data store</a></li>
<li class="chapter" data-level="9.2" data-path="data.html"><a href="data.html#external-files"><i class="fa fa-check"></i><b>9.2</b> External files</a></li>
<li class="chapter" data-level="9.3" data-path="data.html"><a href="data.html#memory"><i class="fa fa-check"></i><b>9.3</b> Memory</a></li>
<li class="chapter" data-level="9.4" data-path="data.html"><a href="data.html#cloud-storage"><i class="fa fa-check"></i><b>9.4</b> Cloud storage</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="data.html"><a href="data.html#cost"><i class="fa fa-check"></i><b>9.4.1</b> Cost</a></li>
<li class="chapter" data-level="9.4.2" data-path="data.html"><a href="data.html#aws-setup"><i class="fa fa-check"></i><b>9.4.2</b> AWS setup</a></li>
<li class="chapter" data-level="9.4.3" data-path="data.html"><a href="data.html#gcp-setup"><i class="fa fa-check"></i><b>9.4.3</b> GCP setup</a></li>
<li class="chapter" data-level="9.4.4" data-path="data.html"><a href="data.html#usage"><i class="fa fa-check"></i><b>9.4.4</b> Usage</a></li>
<li class="chapter" data-level="9.4.5" data-path="data.html"><a href="data.html#data-version-control"><i class="fa fa-check"></i><b>9.4.5</b> Data version control</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="data.html"><a href="data.html#cleaning-up-local-internal-data-files"><i class="fa fa-check"></i><b>9.5</b> Cleaning up local internal data files</a></li>
<li class="chapter" data-level="9.6" data-path="data.html"><a href="data.html#literate-programming"><i class="fa fa-check"></i><b>9.6</b> Literate programming</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>10</b> Literate programming</a>
<ul>
<li class="chapter" data-level="10.1" data-path="markdown.html"><a href="markdown.html#rendering-within-a-target"><i class="fa fa-check"></i><b>10.1</b> Rendering within a target</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="markdown.html"><a href="markdown.html#parameterized-r-markdown"><i class="fa fa-check"></i><b>10.1.1</b> Parameterized R Markdown</a></li>
<li class="chapter" data-level="10.1.2" data-path="markdown.html"><a href="markdown.html#single-parameter-set"><i class="fa fa-check"></i><b>10.1.2</b> Single parameter set</a></li>
<li class="chapter" data-level="10.1.3" data-path="markdown.html"><a href="markdown.html#multiple-parameter-sets"><i class="fa fa-check"></i><b>10.1.3</b> Multiple parameter sets</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="markdown.html"><a href="markdown.html#target-markdown"><i class="fa fa-check"></i><b>10.2</b> Target Markdown</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="markdown.html"><a href="markdown.html#access"><i class="fa fa-check"></i><b>10.2.1</b> Access</a></li>
<li class="chapter" data-level="10.2.2" data-path="markdown.html"><a href="markdown.html#purpose"><i class="fa fa-check"></i><b>10.2.2</b> Purpose</a></li>
<li class="chapter" data-level="10.2.3" data-path="markdown.html"><a href="markdown.html#example"><i class="fa fa-check"></i><b>10.2.3</b> Example</a></li>
<li class="chapter" data-level="10.2.4" data-path="markdown.html"><a href="markdown.html#required-packages"><i class="fa fa-check"></i><b>10.2.4</b> Required packages</a></li>
<li class="chapter" data-level="10.2.5" data-path="markdown.html"><a href="markdown.html#setup"><i class="fa fa-check"></i><b>10.2.5</b> Setup</a></li>
<li class="chapter" data-level="10.2.6" data-path="markdown.html"><a href="markdown.html#globals"><i class="fa fa-check"></i><b>10.2.6</b> Globals</a></li>
<li class="chapter" data-level="10.2.7" data-path="markdown.html"><a href="markdown.html#target-definitions"><i class="fa fa-check"></i><b>10.2.7</b> Target definitions</a></li>
<li class="chapter" data-level="10.2.8" data-path="markdown.html"><a href="markdown.html#pipeline"><i class="fa fa-check"></i><b>10.2.8</b> Pipeline</a></li>
<li class="chapter" data-level="10.2.9" data-path="markdown.html"><a href="markdown.html#output"><i class="fa fa-check"></i><b>10.2.9</b> Output</a></li>
<li class="chapter" data-level="10.2.10" data-path="markdown.html"><a href="markdown.html#conditioning-on-interactive-mode"><i class="fa fa-check"></i><b>10.2.10</b> Conditioning on interactive mode</a></li>
<li class="chapter" data-level="10.2.11" data-path="markdown.html"><a href="markdown.html#tar_interactive"><i class="fa fa-check"></i><b>10.2.11</b> <code>tar_interactive()</code></a></li>
<li class="chapter" data-level="10.2.12" data-path="markdown.html"><a href="markdown.html#tar_toggle"><i class="fa fa-check"></i><b>10.2.12</b> <code>tar_toggle()</code></a></li>
<li class="chapter" data-level="10.2.13" data-path="markdown.html"><a href="markdown.html#chunk-options"><i class="fa fa-check"></i><b>10.2.13</b> Chunk options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>11</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="11.1" data-path="dynamic.html"><a href="dynamic.html#branching"><i class="fa fa-check"></i><b>11.1</b> Branching</a></li>
<li class="chapter" data-level="11.2" data-path="dynamic.html"><a href="dynamic.html#about-dynamic-branching"><i class="fa fa-check"></i><b>11.2</b> About dynamic branching</a></li>
<li class="chapter" data-level="11.3" data-path="dynamic.html"><a href="dynamic.html#patterns"><i class="fa fa-check"></i><b>11.3</b> Patterns</a></li>
<li class="chapter" data-level="11.4" data-path="dynamic.html"><a href="dynamic.html#pattern-construction"><i class="fa fa-check"></i><b>11.4</b> Pattern construction</a></li>
<li class="chapter" data-level="11.5" data-path="dynamic.html"><a href="dynamic.html#branch-provenance"><i class="fa fa-check"></i><b>11.5</b> Branch provenance</a></li>
<li class="chapter" data-level="11.6" data-path="dynamic.html"><a href="dynamic.html#testing-patterns"><i class="fa fa-check"></i><b>11.6</b> Testing patterns</a></li>
<li class="chapter" data-level="11.7" data-path="dynamic.html"><a href="dynamic.html#branching-over-files"><i class="fa fa-check"></i><b>11.7</b> Branching over files</a></li>
<li class="chapter" data-level="11.8" data-path="dynamic.html"><a href="dynamic.html#branching-over-rows"><i class="fa fa-check"></i><b>11.8</b> Branching over rows</a></li>
<li class="chapter" data-level="11.9" data-path="dynamic.html"><a href="dynamic.html#iteration"><i class="fa fa-check"></i><b>11.9</b> Iteration</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="dynamic.html"><a href="dynamic.html#vector-iteration"><i class="fa fa-check"></i><b>11.9.1</b> Vector iteration</a></li>
<li class="chapter" data-level="11.9.2" data-path="dynamic.html"><a href="dynamic.html#list-iteration"><i class="fa fa-check"></i><b>11.9.2</b> List iteration</a></li>
<li class="chapter" data-level="11.9.3" data-path="dynamic.html"><a href="dynamic.html#group-iteration"><i class="fa fa-check"></i><b>11.9.3</b> Group iteration</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="dynamic.html"><a href="dynamic.html#dynamic-branching-performance"><i class="fa fa-check"></i><b>11.10</b> Dynamic branching performance</a></li>
<li class="chapter" data-level="11.11" data-path="dynamic.html"><a href="dynamic.html#batching"><i class="fa fa-check"></i><b>11.11</b> Batching</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>12</b> Static branching</a>
<ul>
<li class="chapter" data-level="12.1" data-path="static.html"><a href="static.html#branching-1"><i class="fa fa-check"></i><b>12.1</b> Branching</a></li>
<li class="chapter" data-level="12.2" data-path="static.html"><a href="static.html#when-to-use-static-branching"><i class="fa fa-check"></i><b>12.2</b> When to use static branching</a></li>
<li class="chapter" data-level="12.3" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>12.3</b> Map</a></li>
<li class="chapter" data-level="12.4" data-path="static.html"><a href="static.html#dynamic-within-static-branching"><i class="fa fa-check"></i><b>12.4</b> Dynamic-within-static branching</a></li>
<li class="chapter" data-level="12.5" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>12.5</b> Combine</a></li>
<li class="chapter" data-level="12.6" data-path="static.html"><a href="static.html#metaprogramming"><i class="fa fa-check"></i><b>12.6</b> Metaprogramming</a></li>
<li class="chapter" data-level="12.7" data-path="static.html"><a href="static.html#hooks"><i class="fa fa-check"></i><b>12.7</b> Hooks</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>13</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hpc.html"><a href="hpc.html#clustermq"><i class="fa fa-check"></i><b>13.1</b> Clustermq</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>13.1.1</b> Persistent workers</a></li>
<li class="chapter" data-level="13.1.2" data-path="hpc.html"><a href="hpc.html#clustermq-installation"><i class="fa fa-check"></i><b>13.1.2</b> Clustermq installation</a></li>
<li class="chapter" data-level="13.1.3" data-path="hpc.html"><a href="hpc.html#clustermq-locally"><i class="fa fa-check"></i><b>13.1.3</b> Clustermq locally</a></li>
<li class="chapter" data-level="13.1.4" data-path="hpc.html"><a href="hpc.html#clustermq-remotely"><i class="fa fa-check"></i><b>13.1.4</b> Clustermq remotely</a></li>
<li class="chapter" data-level="13.1.5" data-path="hpc.html"><a href="hpc.html#clustermq-configuration"><i class="fa fa-check"></i><b>13.1.5</b> Clustermq configuration</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="hpc.html"><a href="hpc.html#future"><i class="fa fa-check"></i><b>13.2</b> Future</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>13.2.1</b> Transient workers</a></li>
<li class="chapter" data-level="13.2.2" data-path="hpc.html"><a href="hpc.html#future-installation"><i class="fa fa-check"></i><b>13.2.2</b> Future installation</a></li>
<li class="chapter" data-level="13.2.3" data-path="hpc.html"><a href="hpc.html#future-locally"><i class="fa fa-check"></i><b>13.2.3</b> Future locally</a></li>
<li class="chapter" data-level="13.2.4" data-path="hpc.html"><a href="hpc.html#future-remotely"><i class="fa fa-check"></i><b>13.2.4</b> Future remotely</a></li>
<li class="chapter" data-level="13.2.5" data-path="hpc.html"><a href="hpc.html#future-configuration"><i class="fa fa-check"></i><b>13.2.5</b> Future configuration</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="hpc.html"><a href="hpc.html#advanced"><i class="fa fa-check"></i><b>13.3</b> Advanced</a></li>
<li class="chapter" data-level="13.4" data-path="hpc.html"><a href="hpc.html#cloud-computing"><i class="fa fa-check"></i><b>13.4</b> Cloud computing</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="drake.html"><a href="drake.html"><i class="fa fa-check"></i><b>14</b> What about <code>drake</code>?</a>
<ul>
<li class="chapter" data-level="14.1" data-path="drake.html"><a href="drake.html#why-is-drake-superseded"><i class="fa fa-check"></i><b>14.1</b> Why is <code>drake</code> superseded?</a></li>
<li class="chapter" data-level="14.2" data-path="drake.html"><a href="drake.html#transitioning-to-targets"><i class="fa fa-check"></i><b>14.2</b> Transitioning to <code>targets</code></a></li>
<li class="chapter" data-level="14.3" data-path="drake.html"><a href="drake.html#advantages-of-targets-over-drake"><i class="fa fa-check"></i><b>14.3</b> Advantages of <code>targets</code> over <code>drake</code></a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="drake.html"><a href="drake.html#better-guardrails-by-design"><i class="fa fa-check"></i><b>14.3.1</b> Better guardrails by design</a></li>
<li class="chapter" data-level="14.3.2" data-path="drake.html"><a href="drake.html#enhanced-debugging-support"><i class="fa fa-check"></i><b>14.3.2</b> Enhanced debugging support</a></li>
<li class="chapter" data-level="14.3.3" data-path="drake.html"><a href="drake.html#improved-tracking-of-package-functions"><i class="fa fa-check"></i><b>14.3.3</b> Improved tracking of package functions</a></li>
<li class="chapter" data-level="14.3.4" data-path="drake.html"><a href="drake.html#lighter-friendlier-data-management"><i class="fa fa-check"></i><b>14.3.4</b> Lighter, friendlier data management</a></li>
<li class="chapter" data-level="14.3.5" data-path="drake.html"><a href="drake.html#cloud-storage-1"><i class="fa fa-check"></i><b>14.3.5</b> Cloud storage</a></li>
<li class="chapter" data-level="14.3.6" data-path="drake.html"><a href="drake.html#show-status-of-functions-and-global-objects"><i class="fa fa-check"></i><b>14.3.6</b> Show status of functions and global objects</a></li>
<li class="chapter" data-level="14.3.7" data-path="drake.html"><a href="drake.html#dynamic-branching-with-dplyrgroup_by"><i class="fa fa-check"></i><b>14.3.7</b> Dynamic branching with <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="14.3.8" data-path="drake.html"><a href="drake.html#composable-dynamic-branching"><i class="fa fa-check"></i><b>14.3.8</b> Composable dynamic branching</a></li>
<li class="chapter" data-level="14.3.9" data-path="drake.html"><a href="drake.html#improved-parallel-efficiency"><i class="fa fa-check"></i><b>14.3.9</b> Improved parallel efficiency</a></li>
<li class="chapter" data-level="14.3.10" data-path="drake.html"><a href="drake.html#metaprogramming-1"><i class="fa fa-check"></i><b>14.3.10</b> Metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The targets R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="markdown" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Literate programming<a href="markdown.html#markdown" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Literate programming is the practice of mixing code and descriptive writing in order to execute and explain a data analysis simultaneously in the same document. The <code>targets</code> package supports literate programming through tight integration with R Markdown and <code>knitr</code>.</p>
<p>There are two kinds of literate programming in <code>targets</code>:</p>
<ol style="list-style-type: decimal">
<li>Rendering within a target. Here, you define a special kind of target that runs a lightweight R Markdown report which depends on upstream targets.</li>
<li>Target Markdown, an overarching system in which one or more R Markdown files write the <code>_targets.R</code> file and encapsulate the pipeline.</li>
</ol>
<div id="rendering-within-a-target" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Rendering within a target<a href="markdown.html#rendering-within-a-target" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you render an R Markdown report as part of a target, the report should be lightweight: mostly prose, minimal code, fast execution, and no output other than the rendered HTML/PDF document. In other words, R Markdown reports are just targets that document prior results. The bulk of the computation should have already happened upstream, and the most of the code chunks in the report itself should be terse calls to <code>tar_read()</code> and <code>tar_load()</code>.</p>
<p>For this chapter, we will use the so-called <a href="https://github.com/ropensci/targets-minimal">“minimal” example</a>, which is similar to the <a href="walkthrough.html#walkthrough">walkthrough example</a> but with an R Markdown report and a slightly different pipeline. The report from that example looks like this:</p>
<p><img src="man/figures/knitr-source.png" /></p>
<p>Above, the report depends on targets <code>fit</code> and <code>hist</code>. The use of <code>tar_read()</code> and <code>tar_load()</code> allows us to run the report outside the pipeline. As long as <code>_targets/</code> folder has data on the required targets from a previous <code>tar_make()</code>, you can open the RStudio IDE, edit the report, and click the Knit button like you would for any other R Markdown report.</p>
<p><img src="man/figures/knitr-ide.png" /></p>
<p>To connect the target with the pipeline, we define a special kind of target using <code>tar_render()</code> from the <a href="https://github.com/ropensci/tarchetypes"><code>tarchetypes</code></a> package instead of the usual <code>tar_target()</code>, which</p>
<ol style="list-style-type: decimal">
<li>Finds all the <code>tar_load()</code>/<code>tar_read()</code> dependencies in the report and inserts them into the target’s command. This enforces the proper dependency relationships. (<code>tar_load_raw()</code> and <code>tar_read_raw()</code> are ignored because those dependencies cannot be resolved with static code analysis.)</li>
<li>Sets <code>format = "file"</code> (see <code>tar_target()</code>) so <code>targets</code> watches the files at the returned paths.</li>
<li>Configures the target’s command to return both the output report files and the input source file. All these file paths are relative paths so the project stays portable.</li>
<li>Forces the report to run in the user’s current working directory instead of the working directory of the report.</li>
<li>Sets convenient default options such as <code>deployment = "main"</code> in <code>tar_target()</code> and <code>quiet = TRUE</code> in <code>rmarkdown::render()</code>.</li>
</ol>
<p>The target definition looks like this.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="markdown.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb79-2"><a href="markdown.html#cb79-2" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>) <span class="co"># Just defines a target object.</span></span>
<span id="cb79-3"><a href="markdown.html#cb79-3" aria-hidden="true" tabindex="-1"></a>target<span class="sc">$</span>command<span class="sc">$</span>expr[[<span class="dv">1</span>]]</span>
<span id="cb79-4"><a href="markdown.html#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tarchetypes::tar_render_run(path = &quot;report.Rmd&quot;, args = list(input = &quot;report.Rmd&quot;, </span></span>
<span id="cb79-5"><a href="markdown.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     knit_root_dir = getwd(), quiet = TRUE), deps = list(fit, </span></span>
<span id="cb79-6"><a href="markdown.html#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     hist))</span></span></code></pre></div>
<p>Because symbols <code>fit</code> and <code>hist</code> appear in the command, <code>targets</code> knows that <code>report</code> depends on the <code>fit</code> target and the <code>hist</code> target. When we put the <code>report</code> target in the pipeline, these dependency relationships show up in the graph.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="markdown.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb80-2"><a href="markdown.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb80-3"><a href="markdown.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb80-4"><a href="markdown.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span>
<span id="cb80-5"><a href="markdown.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb80-6"><a href="markdown.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb80-7"><a href="markdown.html#cb80-7" aria-hidden="true" tabindex="-1"></a>    raw_data_file,</span>
<span id="cb80-8"><a href="markdown.html#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;data/raw_data.csv&quot;</span>,</span>
<span id="cb80-9"><a href="markdown.html#cb80-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">&quot;file&quot;</span></span>
<span id="cb80-10"><a href="markdown.html#cb80-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb80-11"><a href="markdown.html#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb80-12"><a href="markdown.html#cb80-12" aria-hidden="true" tabindex="-1"></a>    raw_data,</span>
<span id="cb80-13"><a href="markdown.html#cb80-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(raw_data_file, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb80-14"><a href="markdown.html#cb80-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb80-15"><a href="markdown.html#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb80-16"><a href="markdown.html#cb80-16" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb80-17"><a href="markdown.html#cb80-17" aria-hidden="true" tabindex="-1"></a>    raw_data <span class="sc">%&gt;%</span></span>
<span id="cb80-18"><a href="markdown.html#cb80-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb80-19"><a href="markdown.html#cb80-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb80-20"><a href="markdown.html#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(hist, <span class="fu">create_plot</span>(data)),</span>
<span id="cb80-21"><a href="markdown.html#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(fit, <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)),</span>
<span id="cb80-22"><a href="markdown.html#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>) <span class="co"># Here is our call to tar_render().</span></span>
<span id="cb80-23"><a href="markdown.html#cb80-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="markdown.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R console</span></span>
<span id="cb81-2"><a href="markdown.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_visnetwork</span>()</span></code></pre></div>
<p><img src="man/figures/knitr-graph.png" /></p>
<div id="parameterized-r-markdown" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Parameterized R Markdown<a href="markdown.html#parameterized-r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functions in <a href="https://docs.ropensci.org/tarchetypes"><code>tarchetypes</code></a> make it straightforward to use <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">parameterized R Markdown</a> in a <code>targets</code> pipeline. The next two subsections walk through the major use cases.</p>
</div>
<div id="single-parameter-set" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Single parameter set<a href="markdown.html#single-parameter-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this scenario, the pipeline renders your <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">parameterized R Markdown</a> report one time using a single set of parameters. These parameters can be upstream targets, global objects, or fixed values. Simply pass a <code>params</code> argument to <a href="https://docs.ropensci.org/tarchetypes/reference/tar_render.html"><code>tarchetypes::tar_render()</code></a>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="markdown.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb82-2"><a href="markdown.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb82-3"><a href="markdown.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb82-4"><a href="markdown.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb82-5"><a href="markdown.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(data, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq_len</span>(<span class="dv">26</span>), <span class="at">y =</span> letters))</span>
<span id="cb82-6"><a href="markdown.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render</span>(report, <span class="st">&quot;report.Rmd&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">your_param =</span> data))</span>
<span id="cb82-7"><a href="markdown.html#cb82-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>the <code>report</code> target will run:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="markdown.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R console</span></span>
<span id="cb83-2"><a href="markdown.html#cb83-2" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="st">&quot;report.Rmd&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">your_param =</span> your_target))</span></code></pre></div>
<p>where <code>report.Rmd</code> has the following YAML front matter:</p>
<pre><code>---
title: report
output_format: html_document
params:
  your_param: &quot;default value&quot;
---</code></pre>
<p>and the following code chunk:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="markdown.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(params<span class="sc">$</span>your_param)</span></code></pre></div>
<p>See <a href="https://docs.ropensci.org/tarchetypes/reference/tar_render.html#examples">these examples</a> for a demonstration.</p>
</div>
<div id="multiple-parameter-sets" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Multiple parameter sets<a href="markdown.html#multiple-parameter-sets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this scenario, you still have a single report, but you render it multiple times over multiple sets of <a href="https://rmarkdown.rstudio.com/developer_parameterized_reports.html">R Markdown parameters</a>. This time, use <a href="https://docs.ropensci.org/tarchetypes/reference/tar_render_rep.html"><code>tarchetypes::tar_render_rep()</code></a> and write code to reference or generate a grid of parameters with one row per rendered report and one column per parameter. Optionally, you can also include an <code>output_file</code> column to control the file paths of the generated reports, and you can set the number of batches to reduce the overhead that would otherwise ensue from creating a large number of targets.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="markdown.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb86-2"><a href="markdown.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb86-3"><a href="markdown.html#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tarchetypes)</span>
<span id="cb86-4"><a href="markdown.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(<span class="at">packages =</span> <span class="st">&quot;tibble&quot;</span>)</span>
<span id="cb86-5"><a href="markdown.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb86-6"><a href="markdown.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(x, <span class="st">&quot;value_of_x&quot;</span>),</span>
<span id="cb86-7"><a href="markdown.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_render_rep</span>(</span>
<span id="cb86-8"><a href="markdown.html#cb86-8" aria-hidden="true" tabindex="-1"></a>    report,</span>
<span id="cb86-9"><a href="markdown.html#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;report.Rmd&quot;</span>,</span>
<span id="cb86-10"><a href="markdown.html#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">tibble</span>(</span>
<span id="cb86-11"><a href="markdown.html#cb86-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&quot;par_val_1&quot;</span>, <span class="st">&quot;par_val_2&quot;</span>, <span class="st">&quot;par_val_3&quot;</span>, <span class="st">&quot;par_val_4&quot;</span>),</span>
<span id="cb86-12"><a href="markdown.html#cb86-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">output_file =</span> <span class="fu">c</span>(<span class="st">&quot;f1.html&quot;</span>, <span class="st">&quot;f2.html&quot;</span>, <span class="st">&quot;f3.html&quot;</span>, <span class="st">&quot;f4.html&quot;</span>)</span>
<span id="cb86-13"><a href="markdown.html#cb86-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb86-14"><a href="markdown.html#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">batches =</span> <span class="dv">2</span></span>
<span id="cb86-15"><a href="markdown.html#cb86-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-16"><a href="markdown.html#cb86-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>where <code>report.Rmd</code> has the following YAML front matter:</p>
<pre><code>title: report
output_format: html_document
params:
  par: &quot;default value&quot;</code></pre>
<p>and the following R code chunk:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="markdown.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(params<span class="sc">$</span>par)</span>
<span id="cb88-2"><a href="markdown.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tar_read</span>(x))</span></code></pre></div>
<p><code>tar_render_rep()</code> creates multiple targets to set up the R Markdown part of the workflow, including a target for the grid of parameters and a <a href="dynamic.html#dynamic">dynamic branching</a> target to iterate over the parameters in batches. In this case, we have two batches (dynamic branches) and each one renders the report twice.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="markdown.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R console</span></span>
<span id="cb89-2"><a href="markdown.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb89-3"><a href="markdown.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target x</span></span>
<span id="cb89-4"><a href="markdown.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target report_params</span></span>
<span id="cb89-5"><a href="markdown.html#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run branch report_9e7470a1</span></span>
<span id="cb89-6"><a href="markdown.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run branch report_457829de</span></span>
<span id="cb89-7"><a href="markdown.html#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● end pipeline</span></span></code></pre></div>
<p>The third output file <code>f3.html</code> is below, and the rest look similar.</p>
<p><img src="man/figures/dynamic-rmarkdown-params.png" /></p>
<p>For more information, see <a href="https://docs.ropensci.org/tarchetypes/reference/tar_render_rep.html#examples">these examples</a>.</p>
</div>
</div>
<div id="target-markdown" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Target Markdown<a href="markdown.html#target-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Target Markdown, available in <code>targets</code> &gt; 0.6.0, is a powerful R Markdown interface for reproducible analysis pipelines. With Target Markdown, you can define a fully scalable pipeline from within one or more R Markdown reports, anything from a single report to a whole <code>bookdown</code> or <code>workflowr</code> project. You get the best of both worlds: the human readable narrative of literate programming, and the sophisticated caching and dependency management systems of <code>targets</code>.</p>
<div id="access" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Access<a href="markdown.html#access" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This chapter’s <a href="https://github.com/ropensci/targets/blob/main/inst/rmarkdown/templates/targets/skeleton/skeleton.Rmd">example Target Markdown document</a> is itself a tutorial and a simplified version of the chapter. There are two convenient ways to access the file:</p>
<ol style="list-style-type: decimal">
<li>The <a href="https://docs.ropensci.org/targets/reference/use_targets.html"><code>use_targets()</code></a> function.</li>
<li>The <a href="https://rstudio.github.io/rstudio-extensions/rmarkdown_templates.html">RStudio R Markdown template system</a>.</li>
</ol>
<p>For (2), in the RStudio IDE, select a new R Markdown document in the New File dropdown menu in the upper left-hand corner of the window.</p>
<p><img src="man/figures/new_rmd.png" /></p>
<p>Then, select the Target Markdown template and click OK to open a copy of the report for editing.</p>
<p><img src="man/figures/target_markdown.png" /></p>
</div>
<div id="purpose" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Purpose<a href="markdown.html#purpose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Target Markdown has two primary objectives:</p>
<ol style="list-style-type: decimal">
<li>Interactively explore, prototype, and test the components of a <code>targets</code> pipeline using the R Markdown <a href="https://bookdown.org/yihui/rmarkdown/notebook.html">notebook interface</a>.</li>
<li>Set up a <code>targets</code> pipeline using convenient R Markdown code chunks.</li>
</ol>
<p>Target Markdown supports a special <code>{targets}</code> <a href="https://bookdown.org/yihui/rmarkdown-cookbook/other-languages.html">language engine</a> with an interactive mode for (1) and a non-interactive mode for (2). By default, the mode is interactive in the <a href="https://bookdown.org/yihui/rmarkdown/notebook.html">notebook interface</a> and non-interactive when you knit/render the whole document.<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>. You can set the mode using the <code>tar_interactive</code> chunk option.</p>
</div>
<div id="example" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Example<a href="markdown.html#example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following example is based on the minimal <code>targets</code> project at <a href="https://github.com/wlandau/targets-minimal/" class="uri">https://github.com/wlandau/targets-minimal/</a>. We process the base <code>airquality</code> dataset, fit a model, and display a histogram of ozone concentration.</p>
</div>
<div id="required-packages" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Required packages<a href="markdown.html#required-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This example requires several R packages, and <code>targets</code> must be version 0.6.0 or above.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="markdown.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R console</span></span>
<span id="cb90-2"><a href="markdown.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;biglm&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>, <span class="st">&quot;readr&quot;</span>, <span class="st">&quot;targets&quot;</span>, <span class="st">&quot;tidyr&quot;</span>))</span></code></pre></div>
</div>
<div id="setup" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Setup<a href="markdown.html#setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, load <code>targets</code> to activate the specialized <code>knitr</code> engine for Target Markdown.</p>
<pre><code>```{r}
library(targets)
```</code></pre>
<p>Non-interactive Target Markdown writes scripts to a special <code>_targets_r/</code> directory to define individual targets and global objects. In order to keep your target definitions up to date, it is recommended to remove <code>_targets_r/</code> at the beginning of the R Markdown document(s) in order to clear out superfluous targets and globals from a previous version. <code>tar_unscript()</code> is a convenient way to do this.</p>
<pre><code>```{r}
tar_unscript()
```</code></pre>
</div>
<div id="globals" class="section level3 hasAnchor" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Globals<a href="markdown.html#globals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As usual, your targets depend on custom functions, global objects, and <code>tar_option_set()</code> options you define before the pipeline begins. Define these globals using the <code>{targets}</code> engine with <code>tar_globals = TRUE</code> chunk option.</p>
<pre><code>```{targets some-globals, tar_globals = TRUE, tar_interactive = TRUE}
options(tidyverse.quiet = TRUE)
tar_option_set(packages = c(&quot;biglm&quot;, &quot;dplyr&quot;, &quot;ggplot2&quot;, &quot;readr&quot;, &quot;tidyr&quot;))
create_plot &lt;- function(data) {
  ggplot(data) +
    geom_histogram(aes(x = Ozone), bins = 12) +
    theme_gray(24)
}
```</code></pre>
<p>In interactive mode, the chunk simply runs the R code in the <code>tar_option_get("envir")</code> environment (usually the global environment) and displays a message:</p>
<pre><code>#&gt; Run code and assign objects to the environment.</code></pre>
<p>Here is the same chunk in non-interactive mode. Normally, there is no need to duplicate chunks like this, but we do so here in order to demonstrate both modes.</p>
<pre><code>```{targets chunk-name, tar_globals = TRUE, tar_interactive = FALSE}
options(tidyverse.quiet = TRUE)
tar_option_set(packages = c(&quot;biglm&quot;, &quot;dplyr&quot;, &quot;ggplot2&quot;, &quot;readr&quot;, &quot;tidyr&quot;))
create_plot &lt;- function(data) {
  ggplot(data) +
    geom_histogram(aes(x = Ozone), bins = 12) +
    theme_gray(24)
}
```</code></pre>
<p>In non-interactive mode, the chunk establishes a common <code>_targets.R</code> file and writes the R code to a script in <code>_targets_r/globals/</code>, and displays an informative message:<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a></p>
<pre><code>#&gt; Establish _targets.R and _targets_r/globals/chunk-name.R.</code></pre>
<p>It is good practice to assign explicit chunk labels or set the <code>tar_name</code> chunk option on a chunk-by-chunk basis. Each chunk writes code to a script path that depends on the name, and all script paths need to be unique.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></p>
</div>
<div id="target-definitions" class="section level3 hasAnchor" number="10.2.7">
<h3><span class="header-section-number">10.2.7</span> Target definitions<a href="markdown.html#target-definitions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To define targets of the pipeline, use the <code>{targets}</code> language engine with the <code>tar_globals</code> chunk option equal <code>FALSE</code> or <code>NULL</code> (default). The return value of the chunk must be a target object or a list of target objects, created by <code>tar_target()</code> or a similar function.</p>
<p>Below, we define a target to establish the air quality dataset in the pipeline.</p>
<pre><code>```{targets raw-data, tar_interactive = TRUE}
tar_target(raw_data, airquality)
```</code></pre>
<p>If you run this chunk in interactive mode, the target’s R command runs, the engine tests if the output can be saved and loaded from disk correctly, and then the return value gets assigned to the <code>tar_option_get("envir")</code> environment (usually the global environment).</p>
<pre><code>#&gt; Run targets and assign them to the environment.</code></pre>
<p>In the process, some temporary files are created and destroyed, but your local file space will remain untouched (barring any custom side effects in your custom code).</p>
<p>After you run a target in interactive mode, the return value is available in memory, and you can write an ordinary R code chunk to read it.</p>
<pre><code>```{r}
head(raw_data)
```</code></pre>
<p>The output is the same as what <code>tar_read(raw_data)</code> would show after a serious pipeline run.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="markdown.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(raw_data)</span>
<span id="cb100-2"><a href="markdown.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Ozone Solar.R Wind Temp Month Day</span></span>
<span id="cb100-3"><a href="markdown.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    41     190  7.4   67     5   1</span></span>
<span id="cb100-4"><a href="markdown.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    36     118  8.0   72     5   2</span></span>
<span id="cb100-5"><a href="markdown.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    12     149 12.6   74     5   3</span></span>
<span id="cb100-6"><a href="markdown.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    18     313 11.5   62     5   4</span></span>
<span id="cb100-7"><a href="markdown.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    NA      NA 14.3   56     5   5</span></span>
<span id="cb100-8"><a href="markdown.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    28      NA 14.9   66     5   6</span></span></code></pre></div>
<p>For demonstration purposes, here is the <code>raw_data</code> target code chunk in non-interactive mode.</p>
<pre><code>```{targets chunk-name-with-target, tar_interactive = FALSE}
tar_target(raw_data, airquality)
```</code></pre>
<p>In non-interactive mode, the <code>{targets}</code> engine does not actually run any targets. Instead, it establishes a common <code>_targets.R</code> and writes the code to a script in <code>_targets_r/targets/</code>.</p>
<pre><code>#&gt; Establish _targets.R and _targets_r/targets/chunk-name-with-target.R.</code></pre>
<p>Next, we define more targets to process the raw data and plot a histogram. Only the returned value of the chunk code actually becomes part of the pipeline, so if you define multiple targets in a single chunk, be sure to wrap them all in a list.</p>
<pre><code>```{targets downstream-targets}
list(
  tar_target(data, raw_data %&gt;% filter(!is.na(Ozone))),
  tar_target(hist, create_plot(data))
)
```</code></pre>
<p>In non-interactive mode, the whole target list gets written to a single script.</p>
<pre><code>#&gt; Establish _targets.R and _targets_r/targets/downstream-targets.R.</code></pre>
<p>Lastly, we define a target to fit a model to the data. For simple targets like this one, we can use convenient shorthand to convert the code in a chunk into a valid target. Simply set the <code>tar_simple</code> chunk option to <code>TRUE</code>.</p>
<pre><code>```{targets fit, tar_simple = TRUE}
analysis_data &lt;- data
biglm(Ozone ~ Wind + Temp, analysis_data)
```</code></pre>
<p>When the chunk is preprocessed, chunk label (or the <code>tar_name</code> chunk option if you set it) becomes the target name, and the chunk code becomes the target command. All other arguments of <code>tar_target()</code> remain at their default values (configurable with <code>tar_option_set()</code> in a <code>tar_globals = TRUE</code> chunk). The output in the rendered R Markdown document reflects this preprocessing.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="markdown.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_target</span>(fit, {</span>
<span id="cb106-2"><a href="markdown.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)</span>
<span id="cb106-3"><a href="markdown.html#cb106-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb106-4"><a href="markdown.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Define target fit from chunk code.</span></span>
<span id="cb106-5"><a href="markdown.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Establish _targets.R and _targets_r/targets/fit.R.</span></span></code></pre></div>
</div>
<div id="pipeline" class="section level3 hasAnchor" number="10.2.8">
<h3><span class="header-section-number">10.2.8</span> Pipeline<a href="markdown.html#pipeline" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you ran all the <code>{targets}</code> chunks in non-interactive mode (i.e. pipeline construction mode), then the target script file and helper scripts should all be established, and you are ready to run the pipeline in with <code>tar_make()</code> in an ordinary <code>{r}</code> code chunk. This time, the output is written to persistent storage at the project root.</p>
<pre><code>```{r}
tar_make()
```</code></pre>
<pre><code>#&gt; • start target raw_data
#&gt; • built target raw_data
#&gt; • start target data
#&gt; • built target data
#&gt; • start target fit
#&gt; • built target fit
#&gt; • start target hist
#&gt; • built target hist
#&gt; • end pipeline: 0.805 seconds</code></pre>
</div>
<div id="output" class="section level3 hasAnchor" number="10.2.9">
<h3><span class="header-section-number">10.2.9</span> Output<a href="markdown.html#output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can retrieve results from the <code>_targets/</code> data store using <code>tar_read()</code> or <code>tar_load()</code>.</p>
<pre><code>```{r}
library(biglm)
tar_read(fit)
```</code></pre>
<pre><code>#&gt; Large data regression model: biglm(Ozone ~ Wind + Temp, data)
#&gt; Sample size =  116</code></pre>
<pre><code>```{r}
tar_read(hist)
```</code></pre>
<p><img src="targets-manual_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>The <code>targets</code> dependency graph helps your readers understand the steps of your pipeline at a high level.</p>
<pre><code>```{r}
tar_visnetwork()
```</code></pre>
<div id="htmlwidget-10dcbbf0f70c9be67c6e" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-10dcbbf0f70c9be67c6e">{"x":{"nodes":{"name":["data","fit","hist","raw_data","create_plot"],"type":["stem","stem","stem","stem","function"],"status":["uptodate","uptodate","uptodate","uptodate","uptodate"],"seconds":[0.008,0.004,0.015,0.625,null],"bytes":[1081,1575,44522,1262,null],"branches":[null,null,null,null,null],"label":["data","fit","hist","raw_data","create_plot"],"color":["#354823","#354823","#354823","#354823","#354823"],"id":["data","fit","hist","raw_data","create_plot"],"level":[2,3,3,1,1],"shape":["dot","dot","dot","dot","triangle"]},"edges":{"from":["data","create_plot","data","raw_data"],"to":["fit","hist","hist","data"],"arrows":["to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"physics":{"stabilization":false},"interaction":{"zoomSpeed":1},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":{"from":1,"to":1},"algorithm":"hierarchical","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Up to date","Stem","Function"],"color":["#354823","#899DA4","#899DA4"],"shape":["dot","dot","triangle"]},"nodesToDataframe":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
<p>At this point, you can go back and run <code>{targets}</code> chunks in interactive mode without interfering with the code or data of the non-interactive pipeline.</p>
</div>
<div id="conditioning-on-interactive-mode" class="section level3 hasAnchor" number="10.2.10">
<h3><span class="header-section-number">10.2.10</span> Conditioning on interactive mode<a href="markdown.html#conditioning-on-interactive-mode" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>targets</code> version 0.6.0.9001 and above supports the <code>tar_interactive()</code> function, which suppresses code unless Target Markdown interactive mode is turned on. Similarly, <code>tar_noninteractive()</code> suppresses code in interactive mode, and <code>tar_toggle()</code> selects alternative pieces of code based on the current mode.</p>
</div>
<div id="tar_interactive" class="section level3 hasAnchor" number="10.2.11">
<h3><span class="header-section-number">10.2.11</span> <code>tar_interactive()</code><a href="markdown.html#tar_interactive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tar_interactive()</code> is useful for dynamic branching. If a dynamic target branches over a target from a different chunk, this ordinarily breaks interactive mode.</p>
<pre><code>```{targets condition, tar_interactive = TRUE}
tar_target(y, x ^ 2, pattern = map(x))
```</code></pre>
<pre><code>#&gt; Run targets and assign them to the environment.
#&gt; Error in `tar_throw_validate()`:
#&gt; ! Target y tried to branch over x, which is illegal. Patterns must only branch over explicitly declared targets in the pipeline. Stems and patterns are fine, but you cannot branch over branches or global objects. Also, if you branch over a target with format = &quot;file&quot;, then that target must also be a pattern.</code></pre>
<p>However, with <code>tar_interactive()</code>, you can define a version of <code>x</code> just for testing and prototyping in interactive mode. The chunk below fixes interactive mode without changing the pipeline in non-interactive mode.</p>
<pre><code>```{targets condition-fixed, tar_interactive = TRUE}
list(
  tar_interactive(tar_target(x, seq_len(2))),
  tar_target(y, x ^ 2, pattern = map(x))
)
```</code></pre>
<pre><code>#&gt; Run targets and assign them to the environment.</code></pre>
</div>
<div id="tar_toggle" class="section level3 hasAnchor" number="10.2.12">
<h3><span class="header-section-number">10.2.12</span> <code>tar_toggle()</code><a href="markdown.html#tar_toggle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tar_toggle()</code> is useful for scaling up and down the amount of work based on the current mode. Interactive mode should finish quickly for prototyping and testing, and non-interactive mode should take on the full level work required for a serious pipeline. Below, <code>tar_toggle()</code> seamlessly scales up and down the number of simulations repetitions in the example target from <a href="https://wlandau.github.io/rmedicine2021-pipeline/#target-definitions" class="uri">https://wlandau.github.io/rmedicine2021-pipeline/#target-definitions</a>. To learn more about <code>stantargets</code>, visit <a href="https://docs.ropensci.org/stantargets/" class="uri">https://docs.ropensci.org/stantargets/</a>.</p>
<pre><code>```{targets bayesian-model-validation, tar_interactive = TRUE}
tar_stan_mcmc_rep_summary(
  name = mcmc,
  stan_files = &quot;model.stan&quot;,
  data = simulate_data(), # Defined in another code chunk.
  batches = tar_toggle(1, 100),
  reps = tar_toggle(1, 10),
  chains = tar_toggle(1, 4),
  parallel_chains = tar_toggle(1, 4),
  iter_warmup = tar_toggle(100, 4e4),
  iter_sampling = tar_toggle(100, 4e4),
  summaries = list(
    ~posterior::quantile2(.x, probs = c(0.025, 0.25, 0.5, 0.75, 0.975)),
    rhat = ~posterior::rhat(.x)
  ),
  deployment = &quot;worker&quot;
)
```</code></pre>
</div>
<div id="chunk-options" class="section level3 hasAnchor" number="10.2.13">
<h3><span class="header-section-number">10.2.13</span> Chunk options<a href="markdown.html#chunk-options" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><code>tar_globals</code>: Logical of length 1, whether to define globals or targets. If <code>TRUE</code>, the chunk code defines functions, objects, and options common to all the targets. If <code>FALSE</code> or <code>NULL</code> (default), then the chunk returns formal targets for the pipeline.</li>
<li><code>tar_interactive</code>: Logical of length 1 to choose whether to run the chunk in interactive mode or non-interactive mode.</li>
<li><code>tar_name</code>: name to use for writing helper script files (e.g. _targets_r/targets/target_script.R) and specifying target names if the tar_simple chunk option is TRUE. All helper scripts and target names must have unique names, so please do not set this option globally with knitr::opts_chunk$set().</li>
<li><code>tar_script</code>: Character of length 1, where to write the target script file in non-interactive mode. Most users can skip this option and stick with the default <code>_targets.R</code> script path. Helper script files are always written next to the target script in a folder with an <code>"_r"</code> suffix. The <code>tar_script</code> path must either be absolute or be relative to the project root (where you call <code>tar_make()</code> or similar). If not specified, the target script path defaults to <code>tar_config_get("script")</code> (default: <code>_targets.R</code>; helpers default: <code>_targets_r/</code>). When you run <code>tar_make()</code> etc. with a non-default target script, you must select the correct target script file either with the <code>script</code> argument or with <code>tar_config_set(script = ...)</code>. The function will <code>source()</code> the script file from the current working directory (i.e. with <code>chdir = FALSE</code> in <code>source()</code>).</li>
<li><code>tar_simple</code>: Logical of length 1. Set to <code>TRUE</code> to define a single target with a simplified interface. In code chunks with <code>tar_simple</code> equal to <code>TRUE</code>, the chunk label (or the <code>tar_name</code> chunk option if you set it) becomes the name, and the chunk code becomes the command. In other words, a code chunk with label <code>targetname</code> and command <code>mycommand()</code> automatically gets converted to <code>tar_target(name = targetname, command = mycommand())</code>. All other arguments of <code>tar_target()</code> remain at their default values (configurable with <code>tar_option_set()</code> in a <code>tar_globals = TRUE</code> chunk).</li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="16">
<li id="fn16"><p>In <code>targets</code> version 0.6.0, the mode is interactive if <code>interactive()</code> is <code>TRUE</code>. In subsequent versions, the mode is interactive if <code>!isTRUE(getOption("knitr.in.progress"))</code> is <code>TRUE</code>.<a href="markdown.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>The <code>_targets.R</code> file from Target Markdown never changes from chunk to chunk or report to report, so you can spread your work over multiple reports without worrying about aligning <code>_targets.R</code> scripts. Just be sure all your chunk names are unique across all the reports of a project, or you set the <code>tar_name</code> chunk option to specify base names of script file paths.<a href="markdown.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>In addition, for <code>bookdown</code> projects, chunk labels should only use alphanumeric characters and dashes.<a href="markdown.html#fnref18" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropensci-books/targets/edit/main/markdown.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/ropensci-books/targets/commits/main/markdown.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
