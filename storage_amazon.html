<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Integration with Amazon S3 storage | The targets R Package User Manual</title>
  <meta name="description" content="In-depth discussion of the major functionality of targets." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Integration with Amazon S3 storage | The targets R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://books.ropensci.org/targets" />
  <meta property="og:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />
  <meta property="og:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="github-repo" content="ropensci-books/targets" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Integration with Amazon S3 storage | The targets R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="twitter:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />

<meta name="author" content="Will Landau" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="man/figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="man/figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="hpc.html"/>
<link rel="next" href="drake.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The targets R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pipeline-toolkits"><i class="fa fa-check"></i><b>1.2</b> Pipeline toolkits</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-targets-package"><i class="fa fa-check"></i><b>1.3</b> The <code>targets</code> package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-this-manual"><i class="fa fa-check"></i><b>1.4</b> About this manual</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-about-drake"><i class="fa fa-check"></i><b>1.5</b> What about <code>drake</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>2</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="2.1" data-path="walkthrough.html"><a href="walkthrough.html#about-this-minimal-example"><i class="fa fa-check"></i><b>2.1</b> About this minimal example</a></li>
<li class="chapter" data-level="2.2" data-path="walkthrough.html"><a href="walkthrough.html#file-structure"><i class="fa fa-check"></i><b>2.2</b> File structure</a></li>
<li class="chapter" data-level="2.3" data-path="walkthrough.html"><a href="walkthrough.html#target-script-file"><i class="fa fa-check"></i><b>2.3</b> Target script file</a></li>
<li class="chapter" data-level="2.4" data-path="walkthrough.html"><a href="walkthrough.html#inspect-the-pipeline"><i class="fa fa-check"></i><b>2.4</b> Inspect the pipeline</a></li>
<li class="chapter" data-level="2.5" data-path="walkthrough.html"><a href="walkthrough.html#run-the-pipeline"><i class="fa fa-check"></i><b>2.5</b> Run the pipeline</a></li>
<li class="chapter" data-level="2.6" data-path="walkthrough.html"><a href="walkthrough.html#changes"><i class="fa fa-check"></i><b>2.6</b> Changes</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="walkthrough.html"><a href="walkthrough.html#change-code"><i class="fa fa-check"></i><b>2.6.1</b> Change code</a></li>
<li class="chapter" data-level="2.6.2" data-path="walkthrough.html"><a href="walkthrough.html#change-data"><i class="fa fa-check"></i><b>2.6.2</b> Change data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="walkthrough.html"><a href="walkthrough.html#read-your-data"><i class="fa fa-check"></i><b>2.7</b> Read your data</a></li>
<li class="chapter" data-level="2.8" data-path="walkthrough.html"><a href="walkthrough.html#read-metadata"><i class="fa fa-check"></i><b>2.8</b> Read metadata</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>3</b> Target Markdown</a>
<ul>
<li class="chapter" data-level="3.1" data-path="markdown.html"><a href="markdown.html#access"><i class="fa fa-check"></i><b>3.1</b> Access</a></li>
<li class="chapter" data-level="3.2" data-path="markdown.html"><a href="markdown.html#purpose"><i class="fa fa-check"></i><b>3.2</b> Purpose</a></li>
<li class="chapter" data-level="3.3" data-path="markdown.html"><a href="markdown.html#example"><i class="fa fa-check"></i><b>3.3</b> Example</a></li>
<li class="chapter" data-level="3.4" data-path="markdown.html"><a href="markdown.html#required-packages"><i class="fa fa-check"></i><b>3.4</b> Required packages</a></li>
<li class="chapter" data-level="3.5" data-path="markdown.html"><a href="markdown.html#setup"><i class="fa fa-check"></i><b>3.5</b> Setup</a></li>
<li class="chapter" data-level="3.6" data-path="markdown.html"><a href="markdown.html#globals"><i class="fa fa-check"></i><b>3.6</b> Globals</a></li>
<li class="chapter" data-level="3.7" data-path="markdown.html"><a href="markdown.html#target-definitions"><i class="fa fa-check"></i><b>3.7</b> Target definitions</a></li>
<li class="chapter" data-level="3.8" data-path="markdown.html"><a href="markdown.html#pipeline"><i class="fa fa-check"></i><b>3.8</b> Pipeline</a></li>
<li class="chapter" data-level="3.9" data-path="markdown.html"><a href="markdown.html#output"><i class="fa fa-check"></i><b>3.9</b> Output</a></li>
<li class="chapter" data-level="3.10" data-path="markdown.html"><a href="markdown.html#conditioning-on-interactive-mode"><i class="fa fa-check"></i><b>3.10</b> Conditioning on interactive mode</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="markdown.html"><a href="markdown.html#tar_interactive"><i class="fa fa-check"></i><b>3.10.1</b> <code>tar_interactive()</code></a></li>
<li class="chapter" data-level="3.10.2" data-path="markdown.html"><a href="markdown.html#tar_toggle"><i class="fa fa-check"></i><b>3.10.2</b> <code>tar_toggle()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="markdown.html"><a href="markdown.html#chunk-options"><i class="fa fa-check"></i><b>3.11</b> Chunk options</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>4</b> Debugging</a>
<ul>
<li class="chapter" data-level="4.1" data-path="debugging.html"><a href="debugging.html#error-messages"><i class="fa fa-check"></i><b>4.1</b> Error messages</a></li>
<li class="chapter" data-level="4.2" data-path="debugging.html"><a href="debugging.html#environment-browser"><i class="fa fa-check"></i><b>4.2</b> Environment browser</a></li>
<li class="chapter" data-level="4.3" data-path="debugging.html"><a href="debugging.html#the-debug-option"><i class="fa fa-check"></i><b>4.3</b> The debug option</a></li>
<li class="chapter" data-level="4.4" data-path="debugging.html"><a href="debugging.html#workspaces"><i class="fa fa-check"></i><b>4.4</b> Workspaces</a></li>
<li class="chapter" data-level="4.5" data-path="debugging.html"><a href="debugging.html#tradeoffs"><i class="fa fa-check"></i><b>4.5</b> Tradeoffs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>5</b> Performance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="performance.html"><a href="performance.html#monitoring-the-pipeline"><i class="fa fa-check"></i><b>5.1</b> Monitoring the pipeline</a></li>
<li class="chapter" data-level="5.2" data-path="performance.html"><a href="performance.html#performance-1"><i class="fa fa-check"></i><b>5.2</b> Performance</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#problems-with-script-based-workflows"><i class="fa fa-check"></i><b>6.1</b> Problems with script-based workflows</a></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>6.2</b> Functions</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>6.3</b> Writing functions</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#functions-in-pipelines"><i class="fa fa-check"></i><b>6.4</b> Functions in pipelines</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#tracking-changes"><i class="fa fa-check"></i><b>6.5</b> Tracking changes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="targets.html"><a href="targets.html"><i class="fa fa-check"></i><b>7</b> Target construction</a>
<ul>
<li class="chapter" data-level="7.1" data-path="targets.html"><a href="targets.html#target-names"><i class="fa fa-check"></i><b>7.1</b> Target names</a></li>
<li class="chapter" data-level="7.2" data-path="targets.html"><a href="targets.html#what-a-target-should-do"><i class="fa fa-check"></i><b>7.2</b> What a target should do</a></li>
<li class="chapter" data-level="7.3" data-path="targets.html"><a href="targets.html#how-much-a-target-should-do"><i class="fa fa-check"></i><b>7.3</b> How much a target should do</a></li>
<li class="chapter" data-level="7.4" data-path="targets.html"><a href="targets.html#working-with-tools-outside-r"><i class="fa fa-check"></i><b>7.4</b> Working with tools outside R</a></li>
<li class="chapter" data-level="7.5" data-path="targets.html"><a href="targets.html#side-effects"><i class="fa fa-check"></i><b>7.5</b> Side effects</a></li>
<li class="chapter" data-level="7.6" data-path="targets.html"><a href="targets.html#dependencies"><i class="fa fa-check"></i><b>7.6</b> Dependencies</a></li>
<li class="chapter" data-level="7.7" data-path="targets.html"><a href="targets.html#return-value"><i class="fa fa-check"></i><b>7.7</b> Return value</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="targets.html"><a href="targets.html#saving"><i class="fa fa-check"></i><b>7.7.1</b> Saving</a></li>
<li class="chapter" data-level="7.7.2" data-path="targets.html"><a href="targets.html#hashing"><i class="fa fa-check"></i><b>7.7.2</b> Hashing</a></li>
<li class="chapter" data-level="7.7.3" data-path="targets.html"><a href="targets.html#workaround"><i class="fa fa-check"></i><b>7.7.3</b> Workaround</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>8</b> Packages</a>
<ul>
<li class="chapter" data-level="8.1" data-path="packages.html"><a href="packages.html#loading-and-configuring-r-packages"><i class="fa fa-check"></i><b>8.1</b> Loading and configuring R packages</a></li>
<li class="chapter" data-level="8.2" data-path="packages.html"><a href="packages.html#r-packages-as-projects"><i class="fa fa-check"></i><b>8.2</b> R packages as projects</a></li>
<li class="chapter" data-level="8.3" data-path="packages.html"><a href="packages.html#target-factories"><i class="fa fa-check"></i><b>8.3</b> Target Factories</a></li>
<li class="chapter" data-level="8.4" data-path="packages.html"><a href="packages.html#package-based-invalidation"><i class="fa fa-check"></i><b>8.4</b> Package-based invalidation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>9</b> Projects</a>
<ul>
<li class="chapter" data-level="9.1" data-path="projects.html"><a href="projects.html#extra-reproducibility"><i class="fa fa-check"></i><b>9.1</b> Extra reproducibility</a></li>
<li class="chapter" data-level="9.2" data-path="projects.html"><a href="projects.html#project-files"><i class="fa fa-check"></i><b>9.2</b> Project files</a></li>
<li class="chapter" data-level="9.3" data-path="projects.html"><a href="projects.html#multiple-projects"><i class="fa fa-check"></i><b>9.3</b> Multiple projects</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="projects.html"><a href="projects.html#create-each-project."><i class="fa fa-check"></i><b>9.3.1</b> Create each project.</a></li>
<li class="chapter" data-level="9.3.2" data-path="projects.html"><a href="projects.html#configure-each-project."><i class="fa fa-check"></i><b>9.3.2</b> Configure each project.</a></li>
<li class="chapter" data-level="9.3.3" data-path="projects.html"><a href="projects.html#run-each-project"><i class="fa fa-check"></i><b>9.3.3</b> Run each project</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="projects.html"><a href="projects.html#interdependent-projects"><i class="fa fa-check"></i><b>9.4</b> Interdependent projects</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="projects.html"><a href="projects.html#config-inheritance"><i class="fa fa-check"></i><b>9.4.1</b> Config inheritance</a></li>
<li class="chapter" data-level="9.4.2" data-path="projects.html"><a href="projects.html#sharing-targets"><i class="fa fa-check"></i><b>9.4.2</b> Sharing targets</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="projects.html"><a href="projects.html#the-config-package"><i class="fa fa-check"></i><b>9.5</b> The config package</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>10</b> External files and literate programming</a>
<ul>
<li class="chapter" data-level="10.1" data-path="files.html"><a href="files.html#internal-data-files"><i class="fa fa-check"></i><b>10.1</b> Internal data files</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="files.html"><a href="files.html#data-version-control-and-the-cloud"><i class="fa fa-check"></i><b>10.1.1</b> Data version control and the cloud</a></li>
<li class="chapter" data-level="10.1.2" data-path="files.html"><a href="files.html#cleaning-up-local-internal-data-files"><i class="fa fa-check"></i><b>10.1.2</b> Cleaning up local internal data files</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="files.html"><a href="files.html#internal-script-files"><i class="fa fa-check"></i><b>10.2</b> Internal script files</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="files.html"><a href="files.html#cleaning-up-internal-script-files"><i class="fa fa-check"></i><b>10.2.1</b> Cleaning up internal script files</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="files.html"><a href="files.html#external-input-files"><i class="fa fa-check"></i><b>10.3</b> External input files</a></li>
<li class="chapter" data-level="10.4" data-path="files.html"><a href="files.html#external-output-files"><i class="fa fa-check"></i><b>10.4</b> External output files</a></li>
<li class="chapter" data-level="10.5" data-path="files.html"><a href="files.html#literate-programming"><i class="fa fa-check"></i><b>10.5</b> Literate programming</a></li>
<li class="chapter" data-level="10.6" data-path="files.html"><a href="files.html#parameterized-r-markdown"><i class="fa fa-check"></i><b>10.6</b> Parameterized R Markdown</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="files.html"><a href="files.html#single-parameter-set"><i class="fa fa-check"></i><b>10.6.1</b> Single parameter set</a></li>
<li class="chapter" data-level="10.6.2" data-path="files.html"><a href="files.html#multiple-parameter-sets"><i class="fa fa-check"></i><b>10.6.2</b> Multiple parameter sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>11</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="11.1" data-path="dynamic.html"><a href="dynamic.html#branching"><i class="fa fa-check"></i><b>11.1</b> Branching</a></li>
<li class="chapter" data-level="11.2" data-path="dynamic.html"><a href="dynamic.html#about-dynamic-branching"><i class="fa fa-check"></i><b>11.2</b> About dynamic branching</a></li>
<li class="chapter" data-level="11.3" data-path="dynamic.html"><a href="dynamic.html#patterns"><i class="fa fa-check"></i><b>11.3</b> Patterns</a></li>
<li class="chapter" data-level="11.4" data-path="dynamic.html"><a href="dynamic.html#pattern-construction"><i class="fa fa-check"></i><b>11.4</b> Pattern construction</a></li>
<li class="chapter" data-level="11.5" data-path="dynamic.html"><a href="dynamic.html#branch-provenance"><i class="fa fa-check"></i><b>11.5</b> Branch provenance</a></li>
<li class="chapter" data-level="11.6" data-path="dynamic.html"><a href="dynamic.html#testing-patterns"><i class="fa fa-check"></i><b>11.6</b> Testing patterns</a></li>
<li class="chapter" data-level="11.7" data-path="dynamic.html"><a href="dynamic.html#branching-over-files"><i class="fa fa-check"></i><b>11.7</b> Branching over files</a></li>
<li class="chapter" data-level="11.8" data-path="dynamic.html"><a href="dynamic.html#branching-over-rows"><i class="fa fa-check"></i><b>11.8</b> Branching over rows</a></li>
<li class="chapter" data-level="11.9" data-path="dynamic.html"><a href="dynamic.html#iteration"><i class="fa fa-check"></i><b>11.9</b> Iteration</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="dynamic.html"><a href="dynamic.html#vector-iteration"><i class="fa fa-check"></i><b>11.9.1</b> Vector iteration</a></li>
<li class="chapter" data-level="11.9.2" data-path="dynamic.html"><a href="dynamic.html#list-iteration"><i class="fa fa-check"></i><b>11.9.2</b> List iteration</a></li>
<li class="chapter" data-level="11.9.3" data-path="dynamic.html"><a href="dynamic.html#group-iteration"><i class="fa fa-check"></i><b>11.9.3</b> Group iteration</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="dynamic.html"><a href="dynamic.html#dynamic-branching-performance"><i class="fa fa-check"></i><b>11.10</b> Dynamic branching performance</a></li>
<li class="chapter" data-level="11.11" data-path="dynamic.html"><a href="dynamic.html#batching"><i class="fa fa-check"></i><b>11.11</b> Batching</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>12</b> Static branching</a>
<ul>
<li class="chapter" data-level="12.1" data-path="static.html"><a href="static.html#branching-1"><i class="fa fa-check"></i><b>12.1</b> Branching</a></li>
<li class="chapter" data-level="12.2" data-path="static.html"><a href="static.html#when-to-use-static-branching"><i class="fa fa-check"></i><b>12.2</b> When to use static branching</a></li>
<li class="chapter" data-level="12.3" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>12.3</b> Map</a></li>
<li class="chapter" data-level="12.4" data-path="static.html"><a href="static.html#dynamic-within-static-branching"><i class="fa fa-check"></i><b>12.4</b> Dynamic-within-static branching</a></li>
<li class="chapter" data-level="12.5" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>12.5</b> Combine</a></li>
<li class="chapter" data-level="12.6" data-path="static.html"><a href="static.html#metaprogramming"><i class="fa fa-check"></i><b>12.6</b> Metaprogramming</a></li>
<li class="chapter" data-level="12.7" data-path="static.html"><a href="static.html#hooks"><i class="fa fa-check"></i><b>12.7</b> Hooks</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>13</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hpc.html"><a href="hpc.html#clustermq"><i class="fa fa-check"></i><b>13.1</b> Clustermq</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>13.1.1</b> Persistent workers</a></li>
<li class="chapter" data-level="13.1.2" data-path="hpc.html"><a href="hpc.html#clustermq-installation"><i class="fa fa-check"></i><b>13.1.2</b> Clustermq installation</a></li>
<li class="chapter" data-level="13.1.3" data-path="hpc.html"><a href="hpc.html#clustermq-locally"><i class="fa fa-check"></i><b>13.1.3</b> Clustermq locally</a></li>
<li class="chapter" data-level="13.1.4" data-path="hpc.html"><a href="hpc.html#clustermq-remotely"><i class="fa fa-check"></i><b>13.1.4</b> Clustermq remotely</a></li>
<li class="chapter" data-level="13.1.5" data-path="hpc.html"><a href="hpc.html#clustermq-configuration"><i class="fa fa-check"></i><b>13.1.5</b> Clustermq configuration</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="hpc.html"><a href="hpc.html#future"><i class="fa fa-check"></i><b>13.2</b> Future</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>13.2.1</b> Transient workers</a></li>
<li class="chapter" data-level="13.2.2" data-path="hpc.html"><a href="hpc.html#future-installation"><i class="fa fa-check"></i><b>13.2.2</b> Future installation</a></li>
<li class="chapter" data-level="13.2.3" data-path="hpc.html"><a href="hpc.html#future-locally"><i class="fa fa-check"></i><b>13.2.3</b> Future locally</a></li>
<li class="chapter" data-level="13.2.4" data-path="hpc.html"><a href="hpc.html#future-remotely"><i class="fa fa-check"></i><b>13.2.4</b> Future remotely</a></li>
<li class="chapter" data-level="13.2.5" data-path="hpc.html"><a href="hpc.html#future-configuration"><i class="fa fa-check"></i><b>13.2.5</b> Future configuration</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="hpc.html"><a href="hpc.html#advanced"><i class="fa fa-check"></i><b>13.3</b> Advanced</a></li>
<li class="chapter" data-level="13.4" data-path="hpc.html"><a href="hpc.html#cloud-computing"><i class="fa fa-check"></i><b>13.4</b> Cloud computing</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="storage_amazon.html"><a href="storage_amazon.html"><i class="fa fa-check"></i><b>14</b> Integration with Amazon S3 storage</a>
<ul>
<li class="chapter" data-level="14.1" data-path="storage_amazon.html"><a href="storage_amazon.html#a-disclaimer"><i class="fa fa-check"></i><b>14.1</b> A disclaimer</a></li>
<li class="chapter" data-level="14.2" data-path="storage_amazon.html"><a href="storage_amazon.html#communicate-with-your-collaborators"><i class="fa fa-check"></i><b>14.2</b> Communicate with your collaborators</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="storage_amazon.html"><a href="storage_amazon.html#get-started-with-the-amazon-s3-web-console"><i class="fa fa-check"></i><b>14.2.1</b> Get started with the Amazon S3 web console</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="storage_amazon.html"><a href="storage_amazon.html#configure-your-local-machine"><i class="fa fa-check"></i><b>14.3</b> Configure your local machine</a></li>
<li class="chapter" data-level="14.4" data-path="storage_amazon.html"><a href="storage_amazon.html#create-s3-buckets"><i class="fa fa-check"></i><b>14.4</b> Create S3 buckets</a></li>
<li class="chapter" data-level="14.5" data-path="storage_amazon.html"><a href="storage_amazon.html#configure-the-pipeline"><i class="fa fa-check"></i><b>14.5</b> Configure the pipeline</a></li>
<li class="chapter" data-level="14.6" data-path="storage_amazon.html"><a href="storage_amazon.html#run-the-pipeline-1"><i class="fa fa-check"></i><b>14.6</b> Run the pipeline</a></li>
<li class="chapter" data-level="14.7" data-path="storage_amazon.html"><a href="storage_amazon.html#manage-the-data"><i class="fa fa-check"></i><b>14.7</b> Manage the data</a></li>
<li class="chapter" data-level="14.8" data-path="storage_amazon.html"><a href="storage_amazon.html#data-version-control"><i class="fa fa-check"></i><b>14.8</b> Data version control</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="drake.html"><a href="drake.html"><i class="fa fa-check"></i><b>15</b> What about <code>drake</code>?</a>
<ul>
<li class="chapter" data-level="15.1" data-path="drake.html"><a href="drake.html#why-is-drake-superseded"><i class="fa fa-check"></i><b>15.1</b> Why is <code>drake</code> superseded?</a></li>
<li class="chapter" data-level="15.2" data-path="drake.html"><a href="drake.html#transitioning-to-targets"><i class="fa fa-check"></i><b>15.2</b> Transitioning to <code>targets</code></a></li>
<li class="chapter" data-level="15.3" data-path="drake.html"><a href="drake.html#advantages-of-targets-over-drake"><i class="fa fa-check"></i><b>15.3</b> Advantages of <code>targets</code> over <code>drake</code></a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="drake.html"><a href="drake.html#better-guardrails-by-design"><i class="fa fa-check"></i><b>15.3.1</b> Better guardrails by design</a></li>
<li class="chapter" data-level="15.3.2" data-path="drake.html"><a href="drake.html#enhanced-debugging-support"><i class="fa fa-check"></i><b>15.3.2</b> Enhanced debugging support</a></li>
<li class="chapter" data-level="15.3.3" data-path="drake.html"><a href="drake.html#improved-tracking-of-package-functions"><i class="fa fa-check"></i><b>15.3.3</b> Improved tracking of package functions</a></li>
<li class="chapter" data-level="15.3.4" data-path="drake.html"><a href="drake.html#lighter-friendlier-data-management"><i class="fa fa-check"></i><b>15.3.4</b> Lighter, friendlier data management</a></li>
<li class="chapter" data-level="15.3.5" data-path="drake.html"><a href="drake.html#cloud-storage"><i class="fa fa-check"></i><b>15.3.5</b> Cloud storage</a></li>
<li class="chapter" data-level="15.3.6" data-path="drake.html"><a href="drake.html#show-status-of-functions-and-global-objects"><i class="fa fa-check"></i><b>15.3.6</b> Show status of functions and global objects</a></li>
<li class="chapter" data-level="15.3.7" data-path="drake.html"><a href="drake.html#dynamic-branching-with-dplyrgroup_by"><i class="fa fa-check"></i><b>15.3.7</b> Dynamic branching with <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="15.3.8" data-path="drake.html"><a href="drake.html#composable-dynamic-branching"><i class="fa fa-check"></i><b>15.3.8</b> Composable dynamic branching</a></li>
<li class="chapter" data-level="15.3.9" data-path="drake.html"><a href="drake.html#improved-parallel-efficiency"><i class="fa fa-check"></i><b>15.3.9</b> Improved parallel efficiency</a></li>
<li class="chapter" data-level="15.3.10" data-path="drake.html"><a href="drake.html#metaprogramming-1"><i class="fa fa-check"></i><b>15.3.10</b> Metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The targets R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="storage_amazon" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Integration with Amazon S3 storage</h1>
<p><code>targets</code> has built-in cloud capabilities to help scale pipelines up and out. Cloud storage solutions are already available, and cloud computing computing solutions are in the works.</p>
<p>Before getting started, please familiarize yourself with the <a href="https://aws.amazon.com/pricing/">pricing model</a> and <a href="https://docs.aws.amazon.com/account-billing/index.html">cost management and monitoring tools</a> of <a href="https://aws.amazon.com/">Amazon Web Services</a>. Everything has a cost, from <a href="https://aws.amazon.com/ec2/">virtual instances</a> to <a href="https://docs.aws.amazon.com/#user_guides">web API calls</a>. <a href="https://aws.amazon.com/free/">Free tier accounts</a> give you a modest monthly budget for some services for the first year, but it is easy to exceed the limits. Developers of reusable software should consider applying for <a href="https://aws.amazon.com/blogs/opensource/aws-promotional-credits-open-source-projects/">promotional credit</a> using <a href="https://pages.awscloud.com/AWS-Credits-for-Open-Source-Projects">this application form</a>.</p>
<p><code>targets</code> supports cloud storage on a target-by-target basis using <a href="https://aws.amazon.com/s3/">Amazon Simple Storage Service (S3)</a>. After a target completes, the return value is uploaded to a user-defined S3 bucket <a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/create-bucket.html">S3 bucket</a>. Follow these steps to get started.</p>
<div id="a-disclaimer" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> A disclaimer</h2>
<p>Please be aware of your resource and monetary constraints when using AWS. The AWS-backed storage capabilities in <code>targets</code> sends individual data files to S3 buckets on a target-by-target basis and periodically queries the HTML header data. For a large number of S3-backed targets, the pipeline may slow down, and it may incur monetary costs due to a large number of API requests, both for uploading new targets and checking if existing targets are up to date. It may be best to select a small number of important or large targets to send to S3 buckets, while putting the majority of small targets under source code version control, e.g. Git/GitHub. To put the whole <code>_targets/</code> data store in a single S3 bucket, including metadata, consider runing the pipeline locally first and then syncing the data (e.g. <code>aws.s3::s3sync()</code>) at only the most important strategic milestones.</p>
</div>
<div id="communicate-with-your-collaborators" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Communicate with your collaborators</h2>
<p>An S3 bucket can be a shared file space. If you have access to someone else’s bucket, running their pipeline could accidentally overwrite their cloud data. It is best if you and your colleagues decide in advance who will write to the bucket at any given time.</p>
<div id="get-started-with-the-amazon-s3-web-console" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Get started with the Amazon S3 web console</h3>
<p>If you do not already have an Amazon Web Services account, sign up for the free tier at <a href="https://aws.amazon.com/free" class="uri">https://aws.amazon.com/free</a>. Then, follow <a href="https://docs.aws.amazon.com/AmazonS3/latest/gsg/GetStartedWithS3.html">these step-by-step instructions</a> to practice using Amazon S3 through the web console at <a href="https://console.aws.amazon.com/s3/" class="uri">https://console.aws.amazon.com/s3/</a>.</p>
</div>
</div>
<div id="configure-your-local-machine" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Configure your local machine</h2>
<p>As of version 0.8.1.9000, <code>targets</code> uses the <a href="https://github.com/paws-r/paws"><code>paws</code></a> package behind the scenes. It is not a strict dependency of <code>targets</code>, so you will need to install it yourself.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="storage_amazon.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;paws&quot;</span>)</span></code></pre></div>
<p>Next, <code>paws</code> needs an access ID, secret access key, and default region. Please refer to the credentials section of the <a href="https://github.com/paws-r/paws/blob/main/README.md"><code>paws</code> README</a> for a list of the appropriate environment variables. Then, set these values in your user-level <code>.Renviron</code> with <code>usethis::edit_r_environ()</code>. Visit <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html" class="uri">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html</a> for more details. Here is an example <code>.Renviron</code> file.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="storage_amazon.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example .Renviron file</span></span>
<span id="cb205-2"><a href="storage_amazon.html#cb205-2" aria-hidden="true" tabindex="-1"></a>AWS_ACCESS_KEY_ID<span class="ot">=</span>AKIAIOSFODNN7EXAMPLE</span>
<span id="cb205-3"><a href="storage_amazon.html#cb205-3" aria-hidden="true" tabindex="-1"></a>AWS_SECRET_ACCESS_KEY<span class="ot">=</span>wJalrXUtnFEMI<span class="sc">/</span>K7MDENG<span class="sc">/</span>bPxRfiCYEXAMPLEKEY</span>
<span id="cb205-4"><a href="storage_amazon.html#cb205-4" aria-hidden="true" tabindex="-1"></a>AWS_REGION<span class="ot">=</span>us<span class="sc">-</span>east<span class="dv">-1</span> <span class="co"># The paws package and thus targets &gt;= 0.8.1.9000 use this.</span></span>
<span id="cb205-5"><a href="storage_amazon.html#cb205-5" aria-hidden="true" tabindex="-1"></a>AWS_DEFAULT_REGION<span class="ot">=</span>us<span class="sc">-</span>east<span class="dv">-1</span> <span class="co"># For back compatibility with targets &lt;= 0.8.1.</span></span></code></pre></div>
<p>Restart your R session so the changes take effect. Your keys are sensitive personal information. You can print them in your private console to verify correctness, but otherwise please avoid saving them to any persistent documents other than <code>.Renviron</code>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="storage_amazon.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_ACCESS_KEY_ID&quot;</span>)</span>
<span id="cb206-2"><a href="storage_amazon.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AKIAIOSFODNN7EXAMPLE&quot;</span></span>
<span id="cb206-3"><a href="storage_amazon.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_SECRET_ACCESS_KEY&quot;</span>)</span>
<span id="cb206-4"><a href="storage_amazon.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY&quot;</span></span>
<span id="cb206-5"><a href="storage_amazon.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_REGION&quot;</span>)</span>
<span id="cb206-6"><a href="storage_amazon.html#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;us-east-1&quot;</span></span>
<span id="cb206-7"><a href="storage_amazon.html#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_DEFAULT_REGION&quot;</span>)</span>
<span id="cb206-8"><a href="storage_amazon.html#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;us-east-1&quot;</span></span></code></pre></div>
</div>
<div id="create-s3-buckets" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Create S3 buckets</h2>
<p>Now, you are ready to create one or more <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html">S3 buckets</a> for your <code>targets</code> pipeline. Each pipeline should have its own set of buckets. Create one through the web console or with <code>aws.s3::put_bucket()</code>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="storage_amazon.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paws)</span>
<span id="cb207-2"><a href="storage_amazon.html#cb207-2" aria-hidden="true" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> <span class="fu">s3</span>()</span>
<span id="cb207-3"><a href="storage_amazon.html#cb207-3" aria-hidden="true" tabindex="-1"></a>s3<span class="sc">$</span><span class="fu">create_bucket</span>(<span class="at">Bucket =</span> <span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>)</span></code></pre></div>
<p>Optionally, enable versionining</p>
<p><code>targets</code> &gt;= 0.9.0 tracks the version IDs of objects in versioning-enabled buckets. (A later section discusses data version control.) You can enable versioning in your bucket through <code>paws</code> or the AWS web console.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="storage_amazon.html#cb208-1" aria-hidden="true" tabindex="-1"></a>s3<span class="sc">$</span><span class="fu">put_bucket_versioning</span>(</span>
<span id="cb208-2"><a href="storage_amazon.html#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bucket =</span> <span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>,</span>
<span id="cb208-3"><a href="storage_amazon.html#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">VersioningConfiguration =</span> <span class="fu">list</span>(</span>
<span id="cb208-4"><a href="storage_amazon.html#cb208-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">MFADelete =</span> <span class="st">&quot;Disabled&quot;</span>,</span>
<span id="cb208-5"><a href="storage_amazon.html#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Status =</span> <span class="st">&quot;Enabled&quot;</span></span>
<span id="cb208-6"><a href="storage_amazon.html#cb208-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb208-7"><a href="storage_amazon.html#cb208-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb208-8"><a href="storage_amazon.html#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; list()</span></span>
<span id="cb208-9"><a href="storage_amazon.html#cb208-9" aria-hidden="true" tabindex="-1"></a>s3<span class="sc">$</span><span class="fu">get_bucket_versioning</span>(<span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>)<span class="sc">$</span>Status</span>
<span id="cb208-10"><a href="storage_amazon.html#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Enabled&quot;</span></span></code></pre></div>
<p>Sign in to <a href="https://s3.console.aws.amazon.com/s3" class="uri">https://s3.console.aws.amazon.com/s3</a> to verify that the bucket exists and has the desired versioning configuration.</p>
</div>
<div id="configure-the-pipeline" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Configure the pipeline</h2>
<p>To connect your pipeline with S3,</p>
<ol style="list-style-type: decimal">
<li>Supply your bucket name to <code>resources</code> in <code>tar_option_set()</code>. To use different buckets for different targets, set <code>resources</code> directly in <code>tar_target()</code>. In older version of <code>targets</code>, <code>resources</code> was a named list. In <code>targets</code> &gt;= 0.5.0.9000, please create the <code>resources</code> argument with helpers <code>tar_resources()</code> and <code>tar_resources_aws()</code>.</li>
<li>Supply AWS-powered storage formats to <code>tar_option_set()</code> and/or <code>tar_target()</code>. See the <a href="https://docs.ropensci.org/targets/reference/tar_target.html#arguments"><code>tar_target()</code> help file</a> for the full list of formats.</li>
</ol>
<p>Your target script file file will look something like this.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="storage_amazon.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example _targets.R</span></span>
<span id="cb209-2"><a href="storage_amazon.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb209-3"><a href="storage_amazon.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="co"># With older versions of targets:</span></span>
<span id="cb209-4"><a href="storage_amazon.html#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tar_option_set(resources = list(bucket = &quot;my-test-bucket-25edb4956460647d&quot;))</span></span>
<span id="cb209-5"><a href="storage_amazon.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With targets &gt;= 0.5.0.9000:</span></span>
<span id="cb209-6"><a href="storage_amazon.html#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(</span>
<span id="cb209-7"><a href="storage_amazon.html#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">resources =</span> <span class="fu">tar_resources</span>(</span>
<span id="cb209-8"><a href="storage_amazon.html#cb209-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">aws =</span> <span class="fu">tar_resources_aws</span>(<span class="at">bucket =</span> <span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>)</span>
<span id="cb209-9"><a href="storage_amazon.html#cb209-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb209-10"><a href="storage_amazon.html#cb209-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-11"><a href="storage_amazon.html#cb209-11" aria-hidden="true" tabindex="-1"></a>write_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb209-12"><a href="storage_amazon.html#cb209-12" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb209-13"><a href="storage_amazon.html#cb209-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(<span class="fu">as.character</span>(<span class="fu">mean</span>(data)), tmp)</span>
<span id="cb209-14"><a href="storage_amazon.html#cb209-14" aria-hidden="true" tabindex="-1"></a>  tmp</span>
<span id="cb209-15"><a href="storage_amazon.html#cb209-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-16"><a href="storage_amazon.html#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb209-17"><a href="storage_amazon.html#cb209-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(data, <span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="at">format =</span> <span class="st">&quot;aws_qs&quot;</span>),</span>
<span id="cb209-18"><a href="storage_amazon.html#cb209-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(mean_file, <span class="fu">write_mean</span>(data), <span class="at">format =</span> <span class="st">&quot;aws_file&quot;</span>)</span>
<span id="cb209-19"><a href="storage_amazon.html#cb209-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="run-the-pipeline-1" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Run the pipeline</h2>
<p>When you run the pipeline above with <a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a>, your local R session computes <code>rnorm(5)</code>, saves it to a temporary <a href="https://github.com/traversc/qs"><code>qs</code></a> file on disk, and then uploads it to a file called <code>_targets/objects/data</code> on your S3 bucket. Likewise for <code>mean_file</code>, but because the format is <code>"aws_file"</code>, you are responsible for supplying the path to the file that gets uploaded to <code>_targets/objects/mean_file</code>.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="storage_amazon.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb210-2"><a href="storage_amazon.html#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target data</span></span>
<span id="cb210-3"><a href="storage_amazon.html#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target mean_file</span></span>
<span id="cb210-4"><a href="storage_amazon.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● end pipeline</span></span></code></pre></div>
<p>And of course, your targets stay up to date if you make no changes.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="storage_amazon.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb211-2"><a href="storage_amazon.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ skip target data</span></span>
<span id="cb211-3"><a href="storage_amazon.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ skip target mean_file</span></span>
<span id="cb211-4"><a href="storage_amazon.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ skip pipeline</span></span></code></pre></div>
</div>
<div id="manage-the-data" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> Manage the data</h2>
<p>Log into <a href="https://s3.console.aws.amazon.com/s3" class="uri">https://s3.console.aws.amazon.com/s3</a>. You should see objects <code>_targets/objects/data</code> and <code>_targets/objects/mean_file</code> in your bucket. To download this data locally, use <code>tar_read()</code> and <code>tar_load()</code> like before. These functions download the data from the bucket and load it into R.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="storage_amazon.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_read</span>(data)</span>
<span id="cb212-2"><a href="storage_amazon.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.74654607 -0.59593497 -1.57229983  0.40915323  0.02579023</span></span></code></pre></div>
<p>The <code>"aws_file"</code> format is different from the other AWS-powered formats. <code>tar_read()</code> and <code>tar_load()</code> download the object to a local path (where the target saved it locally before it was uploaded) and return the path so you can process it yourself.<a href="drake.html#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="storage_amazon.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(mean_file)</span>
<span id="cb213-2"><a href="storage_amazon.html#cb213-2" aria-hidden="true" tabindex="-1"></a>mean_file</span>
<span id="cb213-3"><a href="storage_amazon.html#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;_targets/scratch/mean_fileff086e70876d&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="storage_amazon.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">readLines</span>(mean_file)</span>
<span id="cb214-2"><a href="storage_amazon.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;-0.495967480886693&quot;</span></span></code></pre></div>
<p>When you are done with these temporary files and the pipeline is no longer running, you can safely remove everything in <code>_targets/scratch/</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="storage_amazon.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">&quot;_targets/scratch/&quot;</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Lastly, if you want to erase the whole project or start over from scratch, consider removing the S3 bucket to avoid incurring storage fees. The easiest way to do this is through the <a href="https://s3.console.aws.amazon.com/s3">S3 console</a>. Alternatively, you can programmatically delete the bucket using functions in <code>paws</code>. Either way, the bucket must be empty before it is deleted, including past versions of objects in a versioning-enabled bucket.</p>
</div>
<div id="data-version-control" class="section level2" number="14.8">
<h2><span class="header-section-number">14.8</span> Data version control</h2>
<p>As of version 0.9.0, <code>targets</code> supports built-in native version control through AWS S3 storage. If your bucket has <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">versioning enabled</a>, then <code>targets</code> records the version ID of each target (in <code>tar_meta(your_target)$path</code>), and it uses that version ID to read the data and check the status. So if you revert the metadata file <code>_targets/meta/meta</code> to a prior state, then your pipeline will automatically revert to prior versions of your targets. This allows you to quickly switch your entire project to a <a href="https://git-scm.com/docs/git-checkout">previous state</a> or <a href="https://git-scm.com/docs/git-branch">alternate branch</a> while keeping your AWS-backed targets in sync and up to date. It works best if you commit <code>_targets/meta/meta</code> to the same <a href="https://git-scm.com">version control repository</a> you use for your code. (<a href="https://happygitwithr.com" class="uri">https://happygitwithr.com</a> is an excellent resource to get started with version control for code.)</p>

</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hpc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="drake.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropensci-books/targets/edit/main/storage_amazon.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/ropensci-books/targets/commits/main/storage_amazon.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
