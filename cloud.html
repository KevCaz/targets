<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Cloud integration | The targets R Package User Manual</title>
  <meta name="description" content="In-depth discussion of the major functionality of targets." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Cloud integration | The targets R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://books.ropensci.org/targets" />
  <meta property="og:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />
  <meta property="og:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="github-repo" content="ropensci-books/targets" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Cloud integration | The targets R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="twitter:image" content="https://books.ropensci.org/targets/man/figures/logo.png" />

<meta name="author" content="Will Landau" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="man/figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="man/figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="hpc.html"/>
<link rel="next" href="drake.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The targets R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pipeline-toolkits"><i class="fa fa-check"></i><b>1.2</b> Pipeline toolkits</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-targets-package"><i class="fa fa-check"></i><b>1.3</b> The <code>targets</code> package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-this-manual"><i class="fa fa-check"></i><b>1.4</b> About this manual</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-about-drake"><i class="fa fa-check"></i><b>1.5</b> What about <code>drake</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>2</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="2.1" data-path="walkthrough.html"><a href="walkthrough.html#about-this-minimal-example"><i class="fa fa-check"></i><b>2.1</b> About this minimal example</a></li>
<li class="chapter" data-level="2.2" data-path="walkthrough.html"><a href="walkthrough.html#file-structure"><i class="fa fa-check"></i><b>2.2</b> File structure</a></li>
<li class="chapter" data-level="2.3" data-path="walkthrough.html"><a href="walkthrough.html#inspect-the-pipeline"><i class="fa fa-check"></i><b>2.3</b> Inspect the pipeline</a></li>
<li class="chapter" data-level="2.4" data-path="walkthrough.html"><a href="walkthrough.html#run-the-pipeline"><i class="fa fa-check"></i><b>2.4</b> Run the pipeline</a></li>
<li class="chapter" data-level="2.5" data-path="walkthrough.html"><a href="walkthrough.html#changes"><i class="fa fa-check"></i><b>2.5</b> Changes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="walkthrough.html"><a href="walkthrough.html#change-code"><i class="fa fa-check"></i><b>2.5.1</b> Change code</a></li>
<li class="chapter" data-level="2.5.2" data-path="walkthrough.html"><a href="walkthrough.html#change-data"><i class="fa fa-check"></i><b>2.5.2</b> Change data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="walkthrough.html"><a href="walkthrough.html#read-your-data"><i class="fa fa-check"></i><b>2.6</b> Read your data</a></li>
<li class="chapter" data-level="2.7" data-path="walkthrough.html"><a href="walkthrough.html#read-metadata"><i class="fa fa-check"></i><b>2.7</b> Read metadata</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>3</b> Debugging</a>
<ul>
<li class="chapter" data-level="3.1" data-path="debugging.html"><a href="debugging.html#workspaces"><i class="fa fa-check"></i><b>3.1</b> Workspaces</a></li>
<li class="chapter" data-level="3.2" data-path="debugging.html"><a href="debugging.html#interactive-debugging"><i class="fa fa-check"></i><b>3.2</b> Interactive debugging</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#problems-with-script-based-workflows"><i class="fa fa-check"></i><b>4.1</b> Problems with script-based workflows</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>4.2</b> Functions</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>4.3</b> Writing functions</a></li>
<li class="chapter" data-level="4.4" data-path="functions.html"><a href="functions.html#functions-in-pipelines"><i class="fa fa-check"></i><b>4.4</b> Functions in pipelines</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practices.html"><a href="practices.html"><i class="fa fa-check"></i><b>5</b> Best practices</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practices.html"><a href="practices.html#how-to-define-good-targets"><i class="fa fa-check"></i><b>5.1</b> How to define good targets</a></li>
<li class="chapter" data-level="5.2" data-path="practices.html"><a href="practices.html#dependencies"><i class="fa fa-check"></i><b>5.2</b> Dependencies</a></li>
<li class="chapter" data-level="5.3" data-path="practices.html"><a href="practices.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>5.3</b> Workflows as R packages</a></li>
<li class="chapter" data-level="5.4" data-path="practices.html"><a href="practices.html#working-with-tools-outside-r"><i class="fa fa-check"></i><b>5.4</b> Working with tools outside R</a></li>
<li class="chapter" data-level="5.5" data-path="practices.html"><a href="practices.html#monitoring-the-pipeline"><i class="fa fa-check"></i><b>5.5</b> Monitoring the pipeline</a></li>
<li class="chapter" data-level="5.6" data-path="practices.html"><a href="practices.html#performance"><i class="fa fa-check"></i><b>5.6</b> Performance</a></li>
<li class="chapter" data-level="5.7" data-path="practices.html"><a href="practices.html#cleaning-up"><i class="fa fa-check"></i><b>5.7</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>6</b> External files and literate programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="files.html"><a href="files.html#internal-files"><i class="fa fa-check"></i><b>6.1</b> Internal files</a></li>
<li class="chapter" data-level="6.2" data-path="files.html"><a href="files.html#external-input-files"><i class="fa fa-check"></i><b>6.2</b> External input files</a></li>
<li class="chapter" data-level="6.3" data-path="files.html"><a href="files.html#external-output-files"><i class="fa fa-check"></i><b>6.3</b> External output files</a></li>
<li class="chapter" data-level="6.4" data-path="files.html"><a href="files.html#literate-programming"><i class="fa fa-check"></i><b>6.4</b> Literate programming</a></li>
<li class="chapter" data-level="6.5" data-path="files.html"><a href="files.html#parameterized-r-markdown"><i class="fa fa-check"></i><b>6.5</b> Parameterized R Markdown</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="files.html"><a href="files.html#single-parameter-set"><i class="fa fa-check"></i><b>6.5.1</b> Single parameter set</a></li>
<li class="chapter" data-level="6.5.2" data-path="files.html"><a href="files.html#multiple-parameter-sets"><i class="fa fa-check"></i><b>6.5.2</b> Multiple parameter sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>7</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dynamic.html"><a href="dynamic.html#branching"><i class="fa fa-check"></i><b>7.1</b> Branching</a></li>
<li class="chapter" data-level="7.2" data-path="dynamic.html"><a href="dynamic.html#about-dynamic-branching"><i class="fa fa-check"></i><b>7.2</b> About dynamic branching</a></li>
<li class="chapter" data-level="7.3" data-path="dynamic.html"><a href="dynamic.html#patterns"><i class="fa fa-check"></i><b>7.3</b> Patterns</a></li>
<li class="chapter" data-level="7.4" data-path="dynamic.html"><a href="dynamic.html#pattern-construction"><i class="fa fa-check"></i><b>7.4</b> Pattern construction</a></li>
<li class="chapter" data-level="7.5" data-path="dynamic.html"><a href="dynamic.html#branch-provenance"><i class="fa fa-check"></i><b>7.5</b> Branch provenance</a></li>
<li class="chapter" data-level="7.6" data-path="dynamic.html"><a href="dynamic.html#testing-patterns"><i class="fa fa-check"></i><b>7.6</b> Testing patterns</a></li>
<li class="chapter" data-level="7.7" data-path="dynamic.html"><a href="dynamic.html#dynamic-branching-over-files"><i class="fa fa-check"></i><b>7.7</b> Dynamic branching over files</a></li>
<li class="chapter" data-level="7.8" data-path="dynamic.html"><a href="dynamic.html#iteration"><i class="fa fa-check"></i><b>7.8</b> Iteration</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="dynamic.html"><a href="dynamic.html#vector-iteration"><i class="fa fa-check"></i><b>7.8.1</b> Vector iteration</a></li>
<li class="chapter" data-level="7.8.2" data-path="dynamic.html"><a href="dynamic.html#list-iteration"><i class="fa fa-check"></i><b>7.8.2</b> List iteration</a></li>
<li class="chapter" data-level="7.8.3" data-path="dynamic.html"><a href="dynamic.html#group-iteration"><i class="fa fa-check"></i><b>7.8.3</b> Group iteration</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="dynamic.html"><a href="dynamic.html#batching"><i class="fa fa-check"></i><b>7.9</b> Batching</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>8</b> Static branching</a>
<ul>
<li class="chapter" data-level="8.1" data-path="static.html"><a href="static.html#branching-1"><i class="fa fa-check"></i><b>8.1</b> Branching</a></li>
<li class="chapter" data-level="8.2" data-path="static.html"><a href="static.html#when-to-use-static-branching"><i class="fa fa-check"></i><b>8.2</b> When to use static branching</a></li>
<li class="chapter" data-level="8.3" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>8.3</b> Map</a></li>
<li class="chapter" data-level="8.4" data-path="static.html"><a href="static.html#dynamic-within-static-branching"><i class="fa fa-check"></i><b>8.4</b> Dynamic-within-static branching</a></li>
<li class="chapter" data-level="8.5" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>8.5</b> Combine</a></li>
<li class="chapter" data-level="8.6" data-path="static.html"><a href="static.html#metaprogramming"><i class="fa fa-check"></i><b>8.6</b> Metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>9</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hpc.html"><a href="hpc.html#clustermq"><i class="fa fa-check"></i><b>9.1</b> Clustermq</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hpc.html"><a href="hpc.html#clustermq-installation"><i class="fa fa-check"></i><b>9.1.1</b> Clustermq installation</a></li>
<li class="chapter" data-level="9.1.2" data-path="hpc.html"><a href="hpc.html#clustermq-locally"><i class="fa fa-check"></i><b>9.1.2</b> Clustermq locally</a></li>
<li class="chapter" data-level="9.1.3" data-path="hpc.html"><a href="hpc.html#clustermq-remotely"><i class="fa fa-check"></i><b>9.1.3</b> Clustermq remotely</a></li>
<li class="chapter" data-level="9.1.4" data-path="hpc.html"><a href="hpc.html#clustermq-configuration"><i class="fa fa-check"></i><b>9.1.4</b> Clustermq configuration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hpc.html"><a href="hpc.html#future"><i class="fa fa-check"></i><b>9.2</b> Future</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hpc.html"><a href="hpc.html#future-installation"><i class="fa fa-check"></i><b>9.2.1</b> Future installation</a></li>
<li class="chapter" data-level="9.2.2" data-path="hpc.html"><a href="hpc.html#future-locally"><i class="fa fa-check"></i><b>9.2.2</b> Future locally</a></li>
<li class="chapter" data-level="9.2.3" data-path="hpc.html"><a href="hpc.html#future-remotely"><i class="fa fa-check"></i><b>9.2.3</b> Future remotely</a></li>
<li class="chapter" data-level="9.2.4" data-path="hpc.html"><a href="hpc.html#future-configuration"><i class="fa fa-check"></i><b>9.2.4</b> Future configuration</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hpc.html"><a href="hpc.html#advanced"><i class="fa fa-check"></i><b>9.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cloud.html"><a href="cloud.html"><i class="fa fa-check"></i><b>10</b> Cloud integration</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cloud.html"><a href="cloud.html#compute"><i class="fa fa-check"></i><b>10.1</b> Compute</a></li>
<li class="chapter" data-level="10.2" data-path="cloud.html"><a href="cloud.html#storage"><i class="fa fa-check"></i><b>10.2</b> Storage</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cloud.html"><a href="cloud.html#communicate-with-your-collaborators"><i class="fa fa-check"></i><b>10.2.1</b> Communicate with your collaborators</a></li>
<li class="chapter" data-level="10.2.2" data-path="cloud.html"><a href="cloud.html#get-started-with-the-amazon-s3-web-console"><i class="fa fa-check"></i><b>10.2.2</b> Get started with the Amazon S3 web console</a></li>
<li class="chapter" data-level="10.2.3" data-path="cloud.html"><a href="cloud.html#configure-your-local-machine"><i class="fa fa-check"></i><b>10.2.3</b> Configure your local machine</a></li>
<li class="chapter" data-level="10.2.4" data-path="cloud.html"><a href="cloud.html#create-s3-buckets"><i class="fa fa-check"></i><b>10.2.4</b> Create S3 buckets</a></li>
<li class="chapter" data-level="10.2.5" data-path="cloud.html"><a href="cloud.html#configure-the-pipeline"><i class="fa fa-check"></i><b>10.2.5</b> Configure the pipeline</a></li>
<li class="chapter" data-level="10.2.6" data-path="cloud.html"><a href="cloud.html#run-the-pipeline-1"><i class="fa fa-check"></i><b>10.2.6</b> Run the pipeline</a></li>
<li class="chapter" data-level="10.2.7" data-path="cloud.html"><a href="cloud.html#manage-the-data"><i class="fa fa-check"></i><b>10.2.7</b> Manage the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="drake.html"><a href="drake.html"><i class="fa fa-check"></i><b>11</b> What about <code>drake</code>?</a>
<ul>
<li class="chapter" data-level="11.1" data-path="drake.html"><a href="drake.html#transitioning-to-targets"><i class="fa fa-check"></i><b>11.1</b> Transitioning to <code>targets</code></a></li>
<li class="chapter" data-level="11.2" data-path="drake.html"><a href="drake.html#advantages-of-targets-over-drake"><i class="fa fa-check"></i><b>11.2</b> Advantages of <code>targets</code> over <code>drake</code></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="drake.html"><a href="drake.html#better-guardrails-by-design"><i class="fa fa-check"></i><b>11.2.1</b> Better guardrails by design</a></li>
<li class="chapter" data-level="11.2.2" data-path="drake.html"><a href="drake.html#enhanced-debugging-support"><i class="fa fa-check"></i><b>11.2.2</b> Enhanced debugging support</a></li>
<li class="chapter" data-level="11.2.3" data-path="drake.html"><a href="drake.html#improved-tracking-of-package-functions"><i class="fa fa-check"></i><b>11.2.3</b> Improved tracking of package functions</a></li>
<li class="chapter" data-level="11.2.4" data-path="drake.html"><a href="drake.html#lighter-friendlier-data-management"><i class="fa fa-check"></i><b>11.2.4</b> Lighter, friendlier data management</a></li>
<li class="chapter" data-level="11.2.5" data-path="drake.html"><a href="drake.html#cloud-storage"><i class="fa fa-check"></i><b>11.2.5</b> Cloud storage</a></li>
<li class="chapter" data-level="11.2.6" data-path="drake.html"><a href="drake.html#show-status-of-functions-and-global-objects"><i class="fa fa-check"></i><b>11.2.6</b> Show status of functions and global objects</a></li>
<li class="chapter" data-level="11.2.7" data-path="drake.html"><a href="drake.html#dynamic-branching-with-dplyrgroup_by"><i class="fa fa-check"></i><b>11.2.7</b> Dynamic branching with <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="drake.html"><a href="drake.html#composable-dynamic-branching"><i class="fa fa-check"></i><b>11.2.8</b> Composable dynamic branching</a></li>
<li class="chapter" data-level="11.2.9" data-path="drake.html"><a href="drake.html#improved-parallel-efficiency"><i class="fa fa-check"></i><b>11.2.9</b> Improved parallel efficiency</a></li>
<li class="chapter" data-level="11.2.10" data-path="drake.html"><a href="drake.html#metaprogramming-1"><i class="fa fa-check"></i><b>11.2.10</b> Metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The targets R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cloud" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Cloud integration</h1>
<p><code>targets</code> has built-in cloud capabilities to help scale pipelines up and out. Cloud storage solutions are already available, and cloud computing computing solutions are in the works.</p>
<p>Before getting started, please familiarize yourself with the <a href="https://aws.amazon.com/pricing/">pricing model</a> and <a href="https://docs.aws.amazon.com/account-billing/index.html">cost management and monitoring tools</a> of <a href="https://aws.amazon.com/">Amazon Web Services</a>. Everything has a cost, from <a href="https://aws.amazon.com/ec2/">virtual instances</a> to <a href="https://docs.aws.amazon.com/#user_guides">web API calls</a>. <a href="https://aws.amazon.com/free/">Free tier accounts</a> give you a modest monthly budget for some services for the first year, but it is easy to exceed the limits. Developers of reusable software should consider applying for <a href="https://aws.amazon.com/blogs/opensource/aws-promotional-credits-open-source-projects/">promotional credit</a> using <a href="https://pages.awscloud.com/AWS-Credits-for-Open-Source-Projects">this application form</a>.</p>
<div id="compute" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Compute</h2>
<p>Right now, <code>targets</code> does not have built-in cloud-based distributed computing support. However, future development plans include seamless integration with <a href="https://aws.amazon.com/batch/">AWS Batch</a>. As a temporary workaround, it is possible to deploy a burstable <a href="https://slurm.schedmd.com/documentation.html">SLURM</a> cluster using <a href="https://aws.amazon.com/hpc/parallelcluster/">AWS ParallelCluster</a> and leverage <code>targets</code>’ <a href="hpc.html#hpc">existing support for traditional schedulers</a>.</p>
</div>
<div id="storage" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Storage</h2>
<p><code>targets</code> supports cloud storage on a target-by-target basis using <a href="https://aws.amazon.com/s3/">Amazon Simple Storage Service, or S3</a>. After a target completes, the return value is uploaded to a user-defined S3 bucket <a href="https://docs.aws.amazon.com/AmazonS3/latest/user-guide/create-bucket.html">S3 bucket</a>. Follow these steps to get started.</p>
<div id="communicate-with-your-collaborators" class="section level3" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Communicate with your collaborators</h3>
<p>An S3 bucket can be a shared file space. If you have access to someone else’s bucket, running their pipeline risks overwriting their cloud data. It is best if you and your colleagues decide in advance who will write to the bucket at any given time.</p>
</div>
<div id="get-started-with-the-amazon-s3-web-console" class="section level3" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Get started with the Amazon S3 web console</h3>
<p>If you do not already have an Amazon Web Services account, sign up for the free tier at <a href="https://aws.amazon.com/free" class="uri">https://aws.amazon.com/free</a>. Then, follow <a href="https://docs.aws.amazon.com/AmazonS3/latest/gsg/GetStartedWithS3.html">these step-by-step instructions</a> to practice using Amazon S3 through the web console at <a href="https://console.aws.amazon.com/s3/" class="uri">https://console.aws.amazon.com/s3/</a>.</p>
</div>
<div id="configure-your-local-machine" class="section level3" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Configure your local machine</h3>
<p><code>targets</code> uses the <a href="https://github.com/cloudyr/aws.s3"><code>aws.s3</code></a> package behind the scenes. It is not a strict dependency of <code>targets</code>, so you will need to install it yourself.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="cloud.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;aws.s3&quot;</span>)</span></code></pre></div>
<p>Next, <code>aws.s3</code> needs an access ID, secret access key, and default region. Follow <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-creds">these steps</a> to generate the keys, and choose a region from <a href="https://docs.aws.amazon.com/general/latest/gr/s3.html">this table of endpoints</a>. Then, open the <code>.Renviron</code> file in your home directory with <code>usethis::edit_r_environ()</code> and store this information in <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-envvars.html">special environment variables</a>. Here is an example <code>.Renviron</code> file.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="cloud.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example .Renviron file</span></span>
<span id="cb146-2"><a href="cloud.html#cb146-2" aria-hidden="true" tabindex="-1"></a>AWS_ACCESS_KEY_ID<span class="ot">=</span>AKIAIOSFODNN7EXAMPLE</span>
<span id="cb146-3"><a href="cloud.html#cb146-3" aria-hidden="true" tabindex="-1"></a>AWS_SECRET_ACCESS_KEY<span class="ot">=</span>wJalrXUtnFEMI<span class="sc">/</span>K7MDENG<span class="sc">/</span>bPxRfiCYEXAMPLEKEY</span>
<span id="cb146-4"><a href="cloud.html#cb146-4" aria-hidden="true" tabindex="-1"></a>AWS_DEFAULT_REGION<span class="ot">=</span>us<span class="sc">-</span>east<span class="dv">-1</span></span></code></pre></div>
<p>Restart your R session so the changes take effect. Your keys are sensitive personal information. You can print them in your private console to verify correctness, but otherwise please avoid saving them to any persistent documents other than <code>.Renviron</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="cloud.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_ACCESS_KEY_ID&quot;</span>)</span>
<span id="cb147-2"><a href="cloud.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;AKIAIOSFODNN7EXAMPLE&quot;</span></span>
<span id="cb147-3"><a href="cloud.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_SECRET_ACCESS_KEY&quot;</span>)</span>
<span id="cb147-4"><a href="cloud.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY&quot;</span></span>
<span id="cb147-5"><a href="cloud.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getenv</span>(<span class="st">&quot;AWS_DEFAULT_REGION&quot;</span>)</span>
<span id="cb147-6"><a href="cloud.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;us-east-1&quot;</span></span></code></pre></div>
</div>
<div id="create-s3-buckets" class="section level3" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Create S3 buckets</h3>
<p>Now, you are ready to create one or more <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html">S3 buckets</a> for your <code>targets</code> pipeline. Each pipeline should have its own set of buckets. Create one through the web console or with <code>aws.s3::put_bucket()</code>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="cloud.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aws.s3)</span>
<span id="cb148-2"><a href="cloud.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">put_bucket</span>(<span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>)</span>
<span id="cb148-3"><a href="cloud.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Sign in to <a href="https://s3.console.aws.amazon.com/s3" class="uri">https://s3.console.aws.amazon.com/s3</a> to verify that the bucket exists.</p>
</div>
<div id="configure-the-pipeline" class="section level3" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Configure the pipeline</h3>
<p>To connect your pipeline with S3,</p>
<ol style="list-style-type: decimal">
<li>Supply your bucket name to <code>resources</code> in <code>tar_option_set()</code>. To use different buckets for different targets, set <code>resources</code> directly in <code>tar_target()</code>.</li>
<li>Supply AWS-powered storage formats to <code>tar_option_set()</code> and/or <code>tar_target()</code>. See the <a href="https://docs.ropensci.org/targets/reference/tar_target.html#arguments"><code>tar_target()</code> help file</a> for the full list of formats.</li>
</ol>
<p>Your <code>_targets.R</code> file will look something like this.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="cloud.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example _targets.R</span></span>
<span id="cb149-2"><a href="cloud.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb149-3"><a href="cloud.html#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(<span class="at">resources =</span> <span class="fu">list</span>(<span class="at">bucket =</span> <span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>))</span>
<span id="cb149-4"><a href="cloud.html#cb149-4" aria-hidden="true" tabindex="-1"></a>write_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb149-5"><a href="cloud.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb149-6"><a href="cloud.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLines</span>(<span class="fu">as.character</span>(<span class="fu">mean</span>(data)), tmp)</span>
<span id="cb149-7"><a href="cloud.html#cb149-7" aria-hidden="true" tabindex="-1"></a>  tmp</span>
<span id="cb149-8"><a href="cloud.html#cb149-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-9"><a href="cloud.html#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb149-10"><a href="cloud.html#cb149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(data, <span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="at">format =</span> <span class="st">&quot;aws_qs&quot;</span>),</span>
<span id="cb149-11"><a href="cloud.html#cb149-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(mean_file, <span class="fu">write_mean</span>(data), <span class="at">format =</span> <span class="st">&quot;aws_file&quot;</span>)</span>
<span id="cb149-12"><a href="cloud.html#cb149-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="run-the-pipeline-1" class="section level3" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Run the pipeline</h3>
<p>When you run the pipeline above with <a href="https://docs.ropensci.org/targets/reference/tar_make.html"><code>tar_make()</code></a>, your local R session computes <code>rnorm(5)</code>, saves it to a temporary <a href="https://github.com/traversc/qs"><code>qs</code></a> file on disk, and then uploads it to a file called <code>_targets/objects/data</code> on your S3 bucket. Likewise for <code>mean_file</code>, but because the format is <code>"aws_file"</code>, you are responsible for supplying the path to the file that gets uploaded to <code>_targets/objects/mean_file</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="cloud.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb150-2"><a href="cloud.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target data</span></span>
<span id="cb150-3"><a href="cloud.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ● run target mean_file</span></span></code></pre></div>
<p>And of course, your targets stay up to date if you make no changes.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="cloud.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_make</span>()</span>
<span id="cb151-2"><a href="cloud.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ skip target data</span></span>
<span id="cb151-3"><a href="cloud.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ skip target mean_file</span></span>
<span id="cb151-4"><a href="cloud.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ✓ Already up to date.</span></span></code></pre></div>
</div>
<div id="manage-the-data" class="section level3" number="10.2.7">
<h3><span class="header-section-number">10.2.7</span> Manage the data</h3>
<p>Log into <a href="https://s3.console.aws.amazon.com/s3" class="uri">https://s3.console.aws.amazon.com/s3</a>. You should see objects <code>_targets/objects/data</code> and <code>_targets/objects/mean_file</code> in your bucket. To download this data locally, use <code>tar_read()</code> and <code>tar_load()</code> like before. These functions download the data from the bucket and load it into R.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="cloud.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_read</span>(data)</span>
<span id="cb152-2"><a href="cloud.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.74654607 -0.59593497 -1.57229983  0.40915323  0.02579023</span></span></code></pre></div>
<p>The <code>"aws_file"</code> format is different from the other AWS-powered formats. <code>tar_read()</code> and <code>tar_load()</code> download the object to a temporary file and return the path so you can process it yourself.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="cloud.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(mean_file)</span>
<span id="cb153-2"><a href="cloud.html#cb153-2" aria-hidden="true" tabindex="-1"></a>mean_file</span>
<span id="cb153-3"><a href="cloud.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;_targets/scratch/mean_fileff086e70876d&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="cloud.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">readLines</span>(mean_file)</span>
<span id="cb154-2"><a href="cloud.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;-0.495967480886693&quot;</span></span></code></pre></div>
<p>When you are done with these temporary files and the pipeline is no longer running, you can safely remove everything in <code>_targets/scratch/</code>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="cloud.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlink</span>(<span class="st">&quot;_targets/scratch/&quot;</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Lastly, if you want to erase the whole project or start over from scratch, consider removing the S3 bucket to avoid incurring storage fees. The easiest way to do this is through the <a href="https://s3.console.aws.amazon.com/s3">S3 console</a>. You can alternatively call <code>aws.s3::delete_bucket()</code>, but you have to make sure the bucket is empty first.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="cloud.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">delete_bucket</span>(<span class="st">&quot;my-test-bucket-25edb4956460647d&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>Non-“file” AWS formats also download temporary files, but they are immediately discarded after they are read into memory.<a href="cloud.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hpc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="drake.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropensci-books/targets/edit/main/cloud.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/ropensci-books/targets/commits/main/cloud.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
