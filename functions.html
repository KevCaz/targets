<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Functions | The targets R Package User Manual</title>
  <meta name="description" content="In-depth discussion of the major functionality of targets." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Functions | The targets R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://wlandau.github.io/targets-manual" />
  <meta property="og:image" content="https://wlandau.github.io/targets-manual/man/figures/logo.png" />
  <meta property="og:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="github-repo" content="wlandau/targets-manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Functions | The targets R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth discussion of the major functionality of targets." />
  <meta name="twitter:image" content="https://wlandau.github.io/targets-manual/man/figures/logo.png" />

<meta name="author" content="Will Landau" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="man/figures/apple-touch-icon.png" />
  <link rel="shortcut icon" href="man/figures/favicon.ico" type="image/x-icon" />
<link rel="prev" href="debugging.html"/>
<link rel="next" href="practices.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The targets R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#pipeline-toolkits"><i class="fa fa-check"></i><b>1.2</b> Pipeline toolkits</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-targets-package"><i class="fa fa-check"></i><b>1.3</b> The <code>targets</code> package</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-this-manual"><i class="fa fa-check"></i><b>1.4</b> About this manual</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#what-about-drake"><i class="fa fa-check"></i><b>1.5</b> What about <code>drake</code>?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>2</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="2.1" data-path="walkthrough.html"><a href="walkthrough.html#about-this-minimal-example"><i class="fa fa-check"></i><b>2.1</b> About this minimal example</a></li>
<li class="chapter" data-level="2.2" data-path="walkthrough.html"><a href="walkthrough.html#file-structure"><i class="fa fa-check"></i><b>2.2</b> File structure</a></li>
<li class="chapter" data-level="2.3" data-path="walkthrough.html"><a href="walkthrough.html#inspect-the-pipeline"><i class="fa fa-check"></i><b>2.3</b> Inspect the pipeline</a></li>
<li class="chapter" data-level="2.4" data-path="walkthrough.html"><a href="walkthrough.html#run-the-pipeline"><i class="fa fa-check"></i><b>2.4</b> Run the pipeline</a></li>
<li class="chapter" data-level="2.5" data-path="walkthrough.html"><a href="walkthrough.html#changes"><i class="fa fa-check"></i><b>2.5</b> Changes</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="walkthrough.html"><a href="walkthrough.html#change-code"><i class="fa fa-check"></i><b>2.5.1</b> Change code</a></li>
<li class="chapter" data-level="2.5.2" data-path="walkthrough.html"><a href="walkthrough.html#change-data"><i class="fa fa-check"></i><b>2.5.2</b> Change data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="walkthrough.html"><a href="walkthrough.html#read-your-data"><i class="fa fa-check"></i><b>2.6</b> Read your data</a></li>
<li class="chapter" data-level="2.7" data-path="walkthrough.html"><a href="walkthrough.html#read-metadata"><i class="fa fa-check"></i><b>2.7</b> Read metadata</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>3</b> Debugging</a>
<ul>
<li class="chapter" data-level="3.1" data-path="debugging.html"><a href="debugging.html#workspaces"><i class="fa fa-check"></i><b>3.1</b> Workspaces</a></li>
<li class="chapter" data-level="3.2" data-path="debugging.html"><a href="debugging.html#interactive-debugging"><i class="fa fa-check"></i><b>3.2</b> Interactive debugging</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#problems-with-script-based-workflows"><i class="fa fa-check"></i><b>4.1</b> Problems with script-based workflows</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#functions-1"><i class="fa fa-check"></i><b>4.2</b> Functions</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>4.3</b> Writing functions</a></li>
<li class="chapter" data-level="4.4" data-path="functions.html"><a href="functions.html#functions-in-pipelines"><i class="fa fa-check"></i><b>4.4</b> Functions in pipelines</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practices.html"><a href="practices.html"><i class="fa fa-check"></i><b>5</b> Best practices</a>
<ul>
<li class="chapter" data-level="5.1" data-path="practices.html"><a href="practices.html#how-to-define-good-targets"><i class="fa fa-check"></i><b>5.1</b> How to define good targets</a></li>
<li class="chapter" data-level="5.2" data-path="practices.html"><a href="practices.html#dependencies"><i class="fa fa-check"></i><b>5.2</b> Dependencies</a></li>
<li class="chapter" data-level="5.3" data-path="practices.html"><a href="practices.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>5.3</b> Workflows as R packages</a></li>
<li class="chapter" data-level="5.4" data-path="practices.html"><a href="practices.html#working-with-tools-outside-r"><i class="fa fa-check"></i><b>5.4</b> Working with tools outside R</a></li>
<li class="chapter" data-level="5.5" data-path="practices.html"><a href="practices.html#monitoring-the-pipeline"><i class="fa fa-check"></i><b>5.5</b> Monitoring the pipeline</a></li>
<li class="chapter" data-level="5.6" data-path="practices.html"><a href="practices.html#performance"><i class="fa fa-check"></i><b>5.6</b> Performance</a></li>
<li class="chapter" data-level="5.7" data-path="practices.html"><a href="practices.html#cleaning-up"><i class="fa fa-check"></i><b>5.7</b> Cleaning up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>6</b> External files and literate programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="files.html"><a href="files.html#internal-files"><i class="fa fa-check"></i><b>6.1</b> Internal files</a></li>
<li class="chapter" data-level="6.2" data-path="files.html"><a href="files.html#external-input-files"><i class="fa fa-check"></i><b>6.2</b> External input files</a></li>
<li class="chapter" data-level="6.3" data-path="files.html"><a href="files.html#external-output-files"><i class="fa fa-check"></i><b>6.3</b> External output files</a></li>
<li class="chapter" data-level="6.4" data-path="files.html"><a href="files.html#literate-programming"><i class="fa fa-check"></i><b>6.4</b> Literate programming</a></li>
<li class="chapter" data-level="6.5" data-path="files.html"><a href="files.html#parameterized-r-markdown"><i class="fa fa-check"></i><b>6.5</b> Parameterized R Markdown</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="files.html"><a href="files.html#single-parameter-set"><i class="fa fa-check"></i><b>6.5.1</b> Single parameter set</a></li>
<li class="chapter" data-level="6.5.2" data-path="files.html"><a href="files.html#multiple-parameter-sets"><i class="fa fa-check"></i><b>6.5.2</b> Multiple parameter sets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>7</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dynamic.html"><a href="dynamic.html#branching"><i class="fa fa-check"></i><b>7.1</b> Branching</a></li>
<li class="chapter" data-level="7.2" data-path="dynamic.html"><a href="dynamic.html#abort-dynamic-branching"><i class="fa fa-check"></i><b>7.2</b> Abort dynamic branching</a></li>
<li class="chapter" data-level="7.3" data-path="dynamic.html"><a href="dynamic.html#patterns"><i class="fa fa-check"></i><b>7.3</b> Patterns</a></li>
<li class="chapter" data-level="7.4" data-path="dynamic.html"><a href="dynamic.html#pattern-construction"><i class="fa fa-check"></i><b>7.4</b> Pattern construction</a></li>
<li class="chapter" data-level="7.5" data-path="dynamic.html"><a href="dynamic.html#branch-provenance"><i class="fa fa-check"></i><b>7.5</b> Branch provenance</a></li>
<li class="chapter" data-level="7.6" data-path="dynamic.html"><a href="dynamic.html#testing-patterns"><i class="fa fa-check"></i><b>7.6</b> Testing patterns</a></li>
<li class="chapter" data-level="7.7" data-path="dynamic.html"><a href="dynamic.html#dynamic-branching-over-files"><i class="fa fa-check"></i><b>7.7</b> Dynamic branching over files</a></li>
<li class="chapter" data-level="7.8" data-path="dynamic.html"><a href="dynamic.html#iteration"><i class="fa fa-check"></i><b>7.8</b> Iteration</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="dynamic.html"><a href="dynamic.html#vector-iteration"><i class="fa fa-check"></i><b>7.8.1</b> Vector iteration</a></li>
<li class="chapter" data-level="7.8.2" data-path="dynamic.html"><a href="dynamic.html#list-iteration"><i class="fa fa-check"></i><b>7.8.2</b> List iteration</a></li>
<li class="chapter" data-level="7.8.3" data-path="dynamic.html"><a href="dynamic.html#group-iteration"><i class="fa fa-check"></i><b>7.8.3</b> Group iteration</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="dynamic.html"><a href="dynamic.html#batching"><i class="fa fa-check"></i><b>7.9</b> Batching</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>8</b> Static branching</a>
<ul>
<li class="chapter" data-level="8.1" data-path="static.html"><a href="static.html#branching-1"><i class="fa fa-check"></i><b>8.1</b> Branching</a></li>
<li class="chapter" data-level="8.2" data-path="static.html"><a href="static.html#when-to-use-static-branching"><i class="fa fa-check"></i><b>8.2</b> When to use static branching</a></li>
<li class="chapter" data-level="8.3" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>8.3</b> Map</a></li>
<li class="chapter" data-level="8.4" data-path="static.html"><a href="static.html#dynamic-within-static-branching"><i class="fa fa-check"></i><b>8.4</b> Dynamic-within-static branching</a></li>
<li class="chapter" data-level="8.5" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>8.5</b> Combine</a></li>
<li class="chapter" data-level="8.6" data-path="static.html"><a href="static.html#metaprogramming"><i class="fa fa-check"></i><b>8.6</b> Metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>9</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hpc.html"><a href="hpc.html#clustermq"><i class="fa fa-check"></i><b>9.1</b> Clustermq</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hpc.html"><a href="hpc.html#clustermq-installation"><i class="fa fa-check"></i><b>9.1.1</b> Clustermq installation</a></li>
<li class="chapter" data-level="9.1.2" data-path="hpc.html"><a href="hpc.html#clustermq-locally"><i class="fa fa-check"></i><b>9.1.2</b> Clustermq locally</a></li>
<li class="chapter" data-level="9.1.3" data-path="hpc.html"><a href="hpc.html#clustermq-remotely"><i class="fa fa-check"></i><b>9.1.3</b> Clustermq remotely</a></li>
<li class="chapter" data-level="9.1.4" data-path="hpc.html"><a href="hpc.html#clustermq-configuration"><i class="fa fa-check"></i><b>9.1.4</b> Clustermq configuration</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hpc.html"><a href="hpc.html#future"><i class="fa fa-check"></i><b>9.2</b> Future</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hpc.html"><a href="hpc.html#future-installation"><i class="fa fa-check"></i><b>9.2.1</b> Future installation</a></li>
<li class="chapter" data-level="9.2.2" data-path="hpc.html"><a href="hpc.html#future-locally"><i class="fa fa-check"></i><b>9.2.2</b> Future locally</a></li>
<li class="chapter" data-level="9.2.3" data-path="hpc.html"><a href="hpc.html#future-remotely"><i class="fa fa-check"></i><b>9.2.3</b> Future remotely</a></li>
<li class="chapter" data-level="9.2.4" data-path="hpc.html"><a href="hpc.html#future-configuration"><i class="fa fa-check"></i><b>9.2.4</b> Future configuration</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hpc.html"><a href="hpc.html#advanced"><i class="fa fa-check"></i><b>9.3</b> Advanced</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cloud.html"><a href="cloud.html"><i class="fa fa-check"></i><b>10</b> Cloud integration</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cloud.html"><a href="cloud.html#compute"><i class="fa fa-check"></i><b>10.1</b> Compute</a></li>
<li class="chapter" data-level="10.2" data-path="cloud.html"><a href="cloud.html#storage"><i class="fa fa-check"></i><b>10.2</b> Storage</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cloud.html"><a href="cloud.html#get-started-with-the-amazon-s3-web-console"><i class="fa fa-check"></i><b>10.2.1</b> Get started with the Amazon S3 web console</a></li>
<li class="chapter" data-level="10.2.2" data-path="cloud.html"><a href="cloud.html#configure-your-local-machine"><i class="fa fa-check"></i><b>10.2.2</b> Configure your local machine</a></li>
<li class="chapter" data-level="10.2.3" data-path="cloud.html"><a href="cloud.html#create-s3-buckets"><i class="fa fa-check"></i><b>10.2.3</b> Create S3 buckets</a></li>
<li class="chapter" data-level="10.2.4" data-path="cloud.html"><a href="cloud.html#configure-the-pipeline"><i class="fa fa-check"></i><b>10.2.4</b> Configure the pipeline</a></li>
<li class="chapter" data-level="10.2.5" data-path="cloud.html"><a href="cloud.html#run-the-pipeline-1"><i class="fa fa-check"></i><b>10.2.5</b> Run the pipeline</a></li>
<li class="chapter" data-level="10.2.6" data-path="cloud.html"><a href="cloud.html#manage-the-data"><i class="fa fa-check"></i><b>10.2.6</b> Manage the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="drake.html"><a href="drake.html"><i class="fa fa-check"></i><b>11</b> What about <code>drake</code>?</a>
<ul>
<li class="chapter" data-level="11.1" data-path="drake.html"><a href="drake.html#transitioning-to-targets"><i class="fa fa-check"></i><b>11.1</b> Transitioning to <code>targets</code></a></li>
<li class="chapter" data-level="11.2" data-path="drake.html"><a href="drake.html#advantages-of-targets-over-drake"><i class="fa fa-check"></i><b>11.2</b> Advantages of <code>targets</code> over <code>drake</code></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="drake.html"><a href="drake.html#better-guardrails-by-design"><i class="fa fa-check"></i><b>11.2.1</b> Better guardrails by design</a></li>
<li class="chapter" data-level="11.2.2" data-path="drake.html"><a href="drake.html#enhanced-debugging-support"><i class="fa fa-check"></i><b>11.2.2</b> Enhanced debugging support</a></li>
<li class="chapter" data-level="11.2.3" data-path="drake.html"><a href="drake.html#improved-tracking-of-package-functions"><i class="fa fa-check"></i><b>11.2.3</b> Improved tracking of package functions</a></li>
<li class="chapter" data-level="11.2.4" data-path="drake.html"><a href="drake.html#lighter-friendlier-data-management"><i class="fa fa-check"></i><b>11.2.4</b> Lighter, friendlier data management</a></li>
<li class="chapter" data-level="11.2.5" data-path="drake.html"><a href="drake.html#cloud-storage"><i class="fa fa-check"></i><b>11.2.5</b> Cloud storage</a></li>
<li class="chapter" data-level="11.2.6" data-path="drake.html"><a href="drake.html#show-status-of-functions-and-global-objects"><i class="fa fa-check"></i><b>11.2.6</b> Show status of functions and global objects</a></li>
<li class="chapter" data-level="11.2.7" data-path="drake.html"><a href="drake.html#dynamic-branching-with-dplyrgroup_by"><i class="fa fa-check"></i><b>11.2.7</b> Dynamic branching with <code>dplyr::group_by()</code></a></li>
<li class="chapter" data-level="11.2.8" data-path="drake.html"><a href="drake.html#composable-dynamic-branching"><i class="fa fa-check"></i><b>11.2.8</b> Composable dynamic branching</a></li>
<li class="chapter" data-level="11.2.9" data-path="drake.html"><a href="drake.html#improved-parallel-efficiency"><i class="fa fa-check"></i><b>11.2.9</b> Improved parallel efficiency</a></li>
<li class="chapter" data-level="11.2.10" data-path="drake.html"><a href="drake.html#metaprogramming-1"><i class="fa fa-check"></i><b>11.2.10</b> Metaprogramming</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The targets R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functions" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Functions</h1>
<p><a href="https://github.com/wlandau/targets"><code>targets</code></a> expects users to adopt a function-oriented style of programming. User-defined R functions are essential to express the complexities of data generation, analysis, and reporting. This chapter explains what makes functions useful and how to leverage them in your pipelines.</p>
<div id="problems-with-script-based-workflows" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Problems with script-based workflows</h2>
<p>Traditional data analysis projects consist of imperative scripts, often with with numeric prefixes.</p>
<pre><code>01-data.R
02-model.R
03-plot.R</code></pre>
<p>To run the project, the user runs each of the scripts in order.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="functions.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;01-data.R&quot;</span>)</span>
<span id="cb36-2"><a href="functions.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;02-model.R&quot;</span>)</span>
<span id="cb36-3"><a href="functions.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;03-plot.R&quot;</span>)</span></code></pre></div>
<p>Each script executes a different part of the workflow.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="functions.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 01-data.R</span></span>
<span id="cb37-2"><a href="functions.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-3"><a href="functions.html#cb37-3" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/raw_data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb37-4"><a href="functions.html#cb37-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> raw_data <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="functions.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb37-6"><a href="functions.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(data, <span class="st">&quot;data/data.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="functions.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 02-model.R</span></span>
<span id="cb38-2"><a href="functions.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biglm)</span>
<span id="cb38-3"><a href="functions.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-4"><a href="functions.html#cb38-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb38-5"><a href="functions.html#cb38-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)</span>
<span id="cb38-6"><a href="functions.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit, <span class="st">&quot;fit.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="functions.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 03-plot.R</span></span>
<span id="cb39-2"><a href="functions.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-3"><a href="functions.html#cb39-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb39-4"><a href="functions.html#cb39-4" aria-hidden="true" tabindex="-1"></a>hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb39-5"><a href="functions.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="functions.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_gray</span>(<span class="dv">24</span>)</span>
<span id="cb39-7"><a href="functions.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;hist.png&quot;</span>, hist)</span></code></pre></div>
<p>Although this approach may feel convenient at first, it scales poorly for medium-sized workflows. These <a href="https://en.wikipedia.org/wiki/Imperative_programming">imperative</a> scripts are monolithic, and they grow too large and complicated to understand or maintain.</p>
</div>
<div id="functions-1" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Functions</h2>
<p>Functions are the building blocks of most computer code. They make code easier to think about, and they break down complicated ideas into small manageable pieces. Out of context, you can develop and test a function in isolation without mentally juggling the rest of the project. In the context of the whole workflow, functions are convenient shorthand to make your work easier to read.</p>
<p>In addition, functions are a nice mental model to express data science. A data analysis workflow is a sequence of transformations: datasets map to analyses, and analyses map to summaries. In fact, a function for data science typically falls into one of three categories:</p>
<ol style="list-style-type: decimal">
<li>Process a dataset.</li>
<li>Analyze a dataset.</li>
<li>Summarize an analysis.</li>
</ol>
</div>
<div id="writing-functions" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Writing functions</h2>
<p>Let us begin with our <a href="https://en.wikipedia.org/wiki/Imperative_programming">imperative</a> code for data processing. Every time you look at it, you need to read it carefully and relearn what it does. And test it, you need to copy the entire block into the R console.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="functions.html#cb40-1" aria-hidden="true" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/raw_data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb40-2"><a href="functions.html#cb40-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> raw_data <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="functions.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<p>It is better to encapsulate this code in a function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="functions.html#cb41-1" aria-hidden="true" tabindex="-1"></a>read_and_clean <span class="ot">&lt;-</span> <span class="cf">function</span>(path) {</span>
<span id="cb41-2"><a href="functions.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  raw_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path, <span class="at">col_types =</span> <span class="fu">cols</span>())</span>
<span id="cb41-3"><a href="functions.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  raw_data <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="functions.html#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb41-5"><a href="functions.html#cb41-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, instead of invoking a whole block of text, all you need to do is type a small reusable command. The function name speaks for itself, so you can recall what it does without having to mentally process all the details again.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="functions.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_and_clean</span>(<span class="st">&quot;data/raw_data.csv&quot;</span>)</span></code></pre></div>
<p>As with the data, we can write a function to fit a model,</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="functions.html#cb43-1" aria-hidden="true" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb43-2"><a href="functions.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)</span>
<span id="cb43-3"><a href="functions.html#cb43-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>and another function to plot the data.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="functions.html#cb44-1" aria-hidden="true" tabindex="-1"></a>create_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb44-2"><a href="functions.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb44-3"><a href="functions.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb44-4"><a href="functions.html#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_gray</span>(<span class="dv">24</span>)</span>
<span id="cb44-5"><a href="functions.html#cb44-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="functions-in-pipelines" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Functions in pipelines</h2>
<p>Without those functions, our pipeline in the <a href="walkthrough.html#walkthrough">walkthrough chapter</a> would look long, complicated, and difficult to digest.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="functions.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb45-2"><a href="functions.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb45-3"><a href="functions.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span>
<span id="cb45-4"><a href="functions.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tidyverse.quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-5"><a href="functions.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(<span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;biglm&quot;</span>, <span class="st">&quot;rmarkdown&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb45-6"><a href="functions.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb45-7"><a href="functions.html#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(raw_data_file, <span class="st">&quot;data/raw_data.csv&quot;</span>, <span class="at">format =</span> <span class="st">&quot;file&quot;</span>),</span>
<span id="cb45-8"><a href="functions.html#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(raw_data, <span class="fu">read_csv</span>(raw_data_file, <span class="at">col_types =</span> <span class="fu">cols</span>())),</span>
<span id="cb45-9"><a href="functions.html#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb45-10"><a href="functions.html#cb45-10" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb45-11"><a href="functions.html#cb45-11" aria-hidden="true" tabindex="-1"></a>    raw_data <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="functions.html#cb45-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Ozone =</span> <span class="fu">replace_na</span>(Ozone, <span class="fu">mean</span>(Ozone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb45-13"><a href="functions.html#cb45-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb45-14"><a href="functions.html#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(fit, <span class="fu">biglm</span>(Ozone <span class="sc">~</span> Wind <span class="sc">+</span> Temp, data)),</span>
<span id="cb45-15"><a href="functions.html#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(</span>
<span id="cb45-16"><a href="functions.html#cb45-16" aria-hidden="true" tabindex="-1"></a>    hist,</span>
<span id="cb45-17"><a href="functions.html#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb45-18"><a href="functions.html#cb45-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> Ozone)) <span class="sc">+</span></span>
<span id="cb45-19"><a href="functions.html#cb45-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_gray</span>(<span class="dv">24</span>)</span>
<span id="cb45-20"><a href="functions.html#cb45-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-21"><a href="functions.html#cb45-21" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>But if we write our functions in <code>R/functions.R</code> and <code>source()</code> them into <code>_targets.R</code>, the pipeline becomes much easier to read. We can even condense out <code>raw_data</code> and <code>data</code> targets together without creating a large command.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="functions.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># _targets.R</span></span>
<span id="cb46-2"><a href="functions.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb46-3"><a href="functions.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span>
<span id="cb46-4"><a href="functions.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tidyverse.quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-5"><a href="functions.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_option_set</span>(<span class="at">packages =</span> <span class="fu">c</span>(<span class="st">&quot;biglm&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>))</span>
<span id="cb46-6"><a href="functions.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb46-7"><a href="functions.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(raw_data_file, <span class="st">&quot;data/raw_data.csv&quot;</span>,<span class="at">format =</span> <span class="st">&quot;file&quot;</span>),</span>
<span id="cb46-8"><a href="functions.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(data, <span class="fu">read_and_clean</span>(raw_data_file))</span>
<span id="cb46-9"><a href="functions.html#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(fit, <span class="fu">fit_model</span>(data))</span>
<span id="cb46-10"><a href="functions.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tar_target</span>(hist, <span class="fu">create_plot</span>(data))</span>
<span id="cb46-11"><a href="functions.html#cb46-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>

</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="debugging.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practices.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/wlandau/targets-manual/edit/main/functions.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/wlandau/targets-manual/commits/main/functions.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
